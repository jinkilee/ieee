{} has been added on train_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                      NaN
1         117.000                  0.306795                      NaN
2          22.235                 -0.465926                      NaN
3          59.000                 -0.457572                      NaN
4          53.970                 -0.556525                      NaN
5          30.950                 -1.169763                      NaN
6         311.950                  1.409100                      NaN
7         100.000                  0.940693                      NaN
8          26.000                 -1.360007                      NaN
9         117.000                  0.306795                      NaN
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                      NaN
1         117.000                  0.306795                      NaN
2          22.235                 -0.465926                      NaN
3          59.000                 -0.457572                      NaN
4          53.970                 -0.556525                      NaN
5          30.950                 -1.169763                      NaN
6         311.950                  1.409100                      NaN
7         100.000                  0.940693                      NaN
8          26.000                 -1.360007                      NaN
9         117.000                  0.306795                      NaN
mean/std of fraud_df -> 64      3.552477
71      5.562121
83      3.552477
116     4.827984
127     4.827984
142     4.593688
153     4.827984
159     3.601802
197     4.593688
250     4.827984
290     5.562121
294     3.552477
301     3.552477
337     4.827984
341     3.552477
412     4.827984
489     4.827984
491     4.593688
513     3.552477
532     4.827984
615     3.552477
633     4.593688
682     4.827984
685     3.601802
695     4.827984
707     3.552477
712     3.552477
730     3.601802
742     4.827984
745     4.827984
          ...   
4976    4.593688
4994    4.827984
5000    3.552477
5154    4.827984
5156    4.827984
5165    4.827984
5172    5.562121
5275    3.552477
5342    3.552477
5402    3.552477
5464    4.827984
5488    4.827984
5503    5.562121
5504    4.593688
5525    4.827984
5550    3.552477
5582    4.827984
5589    4.827984
5625    4.593688
5662    4.827984
5667    3.552477
5671    4.827984
5675    4.827984
5709    4.827984
5725    4.827984
5827    3.552477
5832    4.827984
5859    4.827984
5864    3.552477
5876    3.552477
Name: _TransactionAmt, Length: 209, dtype: float64 64      0.791873
71      0.493641
83      0.791873
116     0.961003
127     0.961003
142     1.062575
153     0.961003
159     0.963268
197     1.062575
250     0.961003
290     0.493641
294     0.791873
301     0.791873
337     0.961003
341     0.791873
412     0.961003
489     0.961003
491     1.062575
513     0.791873
532     0.961003
615     0.791873
633     1.062575
682     0.961003
685     0.963268
695     0.961003
707     0.791873
712     0.791873
730     0.963268
742     0.961003
745     0.961003
          ...   
4976    1.062575
4994    0.961003
5000    0.791873
5154    0.961003
5156    0.961003
5165    0.961003
5172    0.493641
5275    0.791873
5342    0.791873
5402    0.791873
5464    0.961003
5488    0.961003
5503    0.493641
5504    1.062575
5525    0.961003
5550    0.791873
5582    0.961003
5589    0.961003
5625    1.062575
5662    0.961003
5667    0.791873
5671    0.961003
5675    0.961003
5709    0.961003
5725    0.961003
5827    0.791873
5832    0.961003
5859    0.961003
5864    0.791873
5876    0.791873
Name: _TransactionAmt, Length: 209, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> 0       4.499221
1       4.499221
2       3.510567
3       4.499221
4       4.499221
5       4.499221
6       4.499221
7       4.041137
8       4.499221
9       4.499221
10      4.499221
11      3.510567
12      4.499221
13      4.499221
14      4.499221
15      4.499221
16      4.499221
17      4.041137
18      4.499221
19      4.499221
20      4.499221
21      4.499221
22      4.499221
23      3.510567
24      3.510567
25      4.499221
26      4.499221
27      4.499221
28      4.499221
29      4.499221
          ...   
5874    4.499221
5875    4.499221
5877    4.041137
5878    4.499221
5879    4.041137
5880    4.499221
5881    3.510567
5882    4.499221
5883    3.510567
5884    4.499221
5885    4.041137
5886    4.041137
5887    4.041137
5888    4.499221
5889    4.499221
5890    4.499221
5891    4.499221
5892    4.499221
5893    4.499221
5894    3.510567
5895    3.731281
5896    4.499221
5897    4.499221
5898    4.499221
5899    4.499221
5900    4.499221
5901    4.499221
5902    4.499221
5903    4.499221
5904    4.499221
Name: _TransactionAmt, Length: 5696, dtype: float64 0       0.884836
1       0.884836
2       0.783188
3       0.884836
4       0.884836
5       0.884836
6       0.884836
7       0.610171
8       0.884836
9       0.884836
10      0.884836
11      0.783188
12      0.884836
13      0.884836
14      0.884836
15      0.884836
16      0.884836
17      0.610171
18      0.884836
19      0.884836
20      0.884836
21      0.884836
22      0.884836
23      0.783188
24      0.783188
25      0.884836
26      0.884836
27      0.884836
28      0.884836
29      0.884836
          ...   
5874    0.884836
5875    0.884836
5877    0.610171
5878    0.884836
5879    0.610171
5880    0.884836
5881    0.783188
5882    0.884836
5883    0.783188
5884    0.884836
5885    0.610171
5886    0.610171
5887    0.610171
5888    0.884836
5889    0.884836
5890    0.884836
5891    0.884836
5892    0.884836
5893    0.884836
5894    0.783188
5895    0.899196
5896    0.884836
5897    0.884836
5898    0.884836
5899    0.884836
5900    0.884836
5901    0.884836
5902    0.884836
5903    0.884836
5904    0.884836
Name: _TransactionAmt, Length: 5696, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                      NaN
1         117.000                  0.306795                      NaN
2          22.235                 -0.465926                      NaN
3          59.000                 -0.457572                      NaN
4          53.970                 -0.556525                      NaN
5          30.950                 -1.169763                      NaN
6         311.950                  1.409100                      NaN
7         100.000                  0.940693                      NaN
8          26.000                 -1.360007                      NaN
9         117.000                  0.306795                      NaN
ProductCD  isFraud
C          1          3.552477
H          1          4.593688
R          1          5.562121
S          1          3.601802
W          1          4.827984
Name: _TransactionAmt, dtype: float64

ProductCD  isFraud
C          1          3.552477
H          1          4.593688
R          1          5.562121
S          1          3.601802
W          1          4.827984
Name: _TransactionAmt, dtype: float64

ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64
mean/std of fraud_df -> ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.791873
H    1.062575
R    0.493641
S    0.963268
W    0.961003
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    3.510567
H    4.041137
R    4.962232
S    3.731281
W    4.499221
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.783188
H    0.610171
R    0.649150
S    0.899196
W    0.884836
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                       NaN                      NaN
1         117.000                       NaN                      NaN
2          22.235                       NaN                      NaN
3          59.000                       NaN                      NaN
4          53.970                       NaN                      NaN
5          30.950                       NaN                      NaN
6         311.950                       NaN                      NaN
7         100.000                       NaN                      NaN
8          26.000                       NaN                      NaN
9         117.000                       NaN                      NaN
mean/std of fraud_df -> ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.791873
H    1.062575
R    0.493641
S    0.963268
W    0.961003
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    3.510567
H    4.041137
R    4.962232
S    3.731281
W    4.499221
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.783188
H    0.610171
R    0.649150
S    0.899196
W    0.884836
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625
mean/std of fraud_df -> ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.791873
H    1.062575
R    0.493641
S    0.963268
W    0.961003
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    3.510567
H    4.041137
R    4.962232
S    3.731281
W    4.499221
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.783188
H    0.610171
R    0.649150
S    0.899196
W    0.884836
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625
original train/test shape: (5905, 440) (5067, 439)
mean/std of fraud_df -> ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.791873
H    1.062575
R    0.493641
S    0.963268
W    0.961003
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    3.510567
H    4.041137
R    4.962232
S    3.731281
W    4.499221
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.783188
H    0.610171
R    0.649150
S    0.899196
W    0.884836
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.490070
H    1.139406
R    2.280444
S    1.723748
W    1.181769
Name: _C1, dtype: float64 ProductCD
C    1.564382
H    0.708436
R    1.819323
S    0.647874
W    0.726859
Name: _C1, dtype: float64
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.928319
H    0.743702
R    0.912605
S    1.111098
W    1.285059
Name: _C1, dtype: float64 ProductCD
C    0.819552
H    0.163379
R    0.970648
S    0.475483
W    0.972168
Name: _C1, dtype: float64
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.669669
H    1.144713
R    2.333281
S    1.485141
W    1.163393
Name: _C2, dtype: float64 ProductCD
C    1.641604
H    0.704586
R    1.846887
S    0.588367
W    0.701441
Name: _C2, dtype: float64
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    1.195126
H    0.718217
R    0.904546
S    1.081009
W    1.247979
Name: _C2, dtype: float64 ProductCD
C    0.977006
H    0.115023
R    0.982813
S    0.487052
W    0.948384
Name: _C2, dtype: float64
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    1.599828
H    0.862164
R    1.782792
S    0.099874
W    1.011572
Name: _C6, dtype: float64 ProductCD
C    1.014942
H    0.351240
R    1.762962
S    0.331244
W    0.669401
Name: _C6, dtype: float64
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.847077
H    0.711946
R    0.872189
S    0.016903
W    1.081991
Name: _C6, dtype: float64 ProductCD
C    0.749888
H    0.092622
R    0.919099
S    0.125627
W    0.948131
Name: _C6, dtype: float64
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.050325
H    1.001578
R    2.036038
S    1.306404
W    0.982301
Name: _C11, dtype: float64 ProductCD
C    1.313948
H    0.522294
R    1.811041
S    0.669220
W    0.617414
Name: _C11, dtype: float64
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.920197
H    0.717500
R    0.874538
S    1.024402
W    1.109181
Name: _C11, dtype: float64 ProductCD
C    0.791204
H    0.110033
R    0.929250
S    0.465007
W    0.887410
Name: _C11, dtype: float64
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    1.113005
H    0.362961
R    0.801050
S    2.562244
W    1.536979
Name: _C13, dtype: float64 ProductCD
C    1.035153
H    0.577043
R    1.855570
S    1.521934
W    1.259921
Name: _C13, dtype: float64
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.942898
H    0.559465
R    0.802088
S    2.258434
W    2.052499
Name: _C13, dtype: float64 ProductCD
C    0.896936
H    0.323533
R    0.941550
S    1.584043
W    1.448271
Name: _C13, dtype: float64
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    0.904414
H    0.337079
R    0.778008
S    1.149789
W    0.936751
Name: _C14, dtype: float64 ProductCD
C    0.826330
H    0.502909
R    1.821283
S    0.693983
W    0.683898
Name: _C14, dtype: float64
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.770787
H    0.546260
R    0.769868
S    1.011855
W    1.195559
Name: _C14, dtype: float64 ProductCD
C    0.710512
H    0.306032
R    0.920754
S    0.493506
W    0.941592
Name: _C14, dtype: float64
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625
original train/test shape: (5905, 440) (5067, 439)
mean/std of fraud_df -> ProductCD
C    3.552477
H    4.593688
R    5.562121
S    3.601802
W    4.827984
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.791873
H    1.062575
R    0.493641
S    0.963268
W    0.961003
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    3.510567
H    4.041137
R    4.962232
S    3.731281
W    4.499221
Name: _TransactionAmt, dtype: float64 ProductCD
C    0.783188
H    0.610171
R    0.649150
S    0.899196
W    0.884836
Name: _TransactionAmt, dtype: float64
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.490070
H    1.139406
R    2.280444
S    1.723748
W    1.181769
Name: _C1, dtype: float64 ProductCD
C    1.564382
H    0.708436
R    1.819323
S    0.647874
W    0.726859
Name: _C1, dtype: float64
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.928319
H    0.743702
R    0.912605
S    1.111098
W    1.285059
Name: _C1, dtype: float64 ProductCD
C    0.819552
H    0.163379
R    0.970648
S    0.475483
W    0.972168
Name: _C1, dtype: float64
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.669669
H    1.144713
R    2.333281
S    1.485141
W    1.163393
Name: _C2, dtype: float64 ProductCD
C    1.641604
H    0.704586
R    1.846887
S    0.588367
W    0.701441
Name: _C2, dtype: float64
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    1.195126
H    0.718217
R    0.904546
S    1.081009
W    1.247979
Name: _C2, dtype: float64 ProductCD
C    0.977006
H    0.115023
R    0.982813
S    0.487052
W    0.948384
Name: _C2, dtype: float64
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    1.599828
H    0.862164
R    1.782792
S    0.099874
W    1.011572
Name: _C6, dtype: float64 ProductCD
C    1.014942
H    0.351240
R    1.762962
S    0.331244
W    0.669401
Name: _C6, dtype: float64
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.847077
H    0.711946
R    0.872189
S    0.016903
W    1.081991
Name: _C6, dtype: float64 ProductCD
C    0.749888
H    0.092622
R    0.919099
S    0.125627
W    0.948131
Name: _C6, dtype: float64
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    2.050325
H    1.001578
R    2.036038
S    1.306404
W    0.982301
Name: _C11, dtype: float64 ProductCD
C    1.313948
H    0.522294
R    1.811041
S    0.669220
W    0.617414
Name: _C11, dtype: float64
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.920197
H    0.717500
R    0.874538
S    1.024402
W    1.109181
Name: _C11, dtype: float64 ProductCD
C    0.791204
H    0.110033
R    0.929250
S    0.465007
W    0.887410
Name: _C11, dtype: float64
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    1.113005
H    0.362961
R    0.801050
S    2.562244
W    1.536979
Name: _C13, dtype: float64 ProductCD
C    1.035153
H    0.577043
R    1.855570
S    1.521934
W    1.259921
Name: _C13, dtype: float64
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.942898
H    0.559465
R    0.802088
S    2.258434
W    2.052499
Name: _C13, dtype: float64 ProductCD
C    0.896936
H    0.323533
R    0.941550
S    1.584043
W    1.448271
Name: _C13, dtype: float64
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
mean/std of fraud_df -> ProductCD
C    0.904414
H    0.337079
R    0.778008
S    1.149789
W    0.936751
Name: _C14, dtype: float64 ProductCD
C    0.826330
H    0.502909
R    1.821283
S    0.693983
W    0.683898
Name: _C14, dtype: float64
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
mean/std of normal_df -> ProductCD
C    0.770787
H    0.546260
R    0.769868
S    1.011855
W    1.195559
Name: _C14, dtype: float64 ProductCD
C    0.710512
H    0.306032
R    0.920754
S    0.493506
W    0.941592
Name: _C14, dtype: float64
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

      nd_TransactionAmt_fraud  nd_TransactionAmt_normal  nd_C1_fraud  \
0                   -0.059625                  0.306795    -0.672238   
1                   -0.059625                  0.306795     0.281382   
2                   -0.513741                 -0.465926    -1.148647   
3                   -0.763410                 -0.457572    -0.114406   
4                   -0.854520                 -0.556525     5.230499   
5                   -1.419155                 -1.169763     5.172766   
6                    0.955314                  1.409100     0.281382   
7                    0.020170                  0.940693    -0.629921   
8                   -1.594321                 -1.360007    -0.672238   
9                   -0.059625                  0.306795    -0.114406   
10                  -1.267861                 -1.005446     0.839213   
11                  -0.118172                 -0.065970    -1.148647   
12                  -1.062766                 -0.782696    -0.672238   
13                  -0.781782                 -0.477525    -0.672238   
14                  -0.932524                 -0.641243    -0.672238   
15                  -0.059625                  0.306795    -0.114406   
16                   2.609049                  3.205189    -0.672238   
17                  -1.091406                 -0.995048    -0.629921   
18                  -1.653799                 -1.424605    -0.672238   
19                  -1.185329                 -0.915809    -0.672238   
20                  -0.490399                 -0.161060    -0.672238   
21                  -0.781782                 -0.477525     0.588379   
22                  -1.051268                 -0.770208    -0.672238   
23                   0.571394                  0.631242    -0.889462   
24                   0.261553                  0.317966    -0.889462   
25                   0.746297                  1.182090     0.281382   
26                   1.146169                  1.616384    -0.672238   
27                   0.263381                  0.657605     0.281382   
28                  -0.059625                  0.306795    -0.672238   
29                  -0.781782                 -0.477525    -0.672238   
...                       ...                       ...          ...   
5875                -0.242839                  0.107810     2.802614   
5876                -0.841892                 -0.797716     1.867560   
5877                -0.622886                 -0.179148    -0.629921   
5878                -1.596250                 -1.362102    -0.672238   
5879                -1.256939                 -1.283312    -0.629921   
5880                 2.409559                  2.988527    -0.672238   
5881                 0.519357                  0.578629    -1.148647   
5882                 1.323965                  1.809485    -0.114406   
5883                -0.303956                 -0.253814    -1.148647   
5884                -0.059625                  0.306795    -0.672238   
5885                 0.398646                  1.599786    -0.629921   
5886                -1.256939                 -1.283312    -0.629921   
5887                -0.622886                 -0.179148    -0.629921   
5888                -1.086151                 -0.808094    -0.114406   
5889                -1.484685                 -1.240934    -0.114406   
5890                -0.142658                  0.216614    -0.672238   
5891                -1.051268                 -0.770208    -0.672238   
5892                -0.932524                 -0.641243     0.588379   
5893                -0.451128                 -0.118408    -0.672238   
5894                -0.170747                 -0.119128    -0.889462   
5895                 0.342608                  0.223026    -0.176438   
5896                 1.160054                  1.631464    -0.114406   
5897                -0.912318                 -0.619298    -0.114406   
5898                 1.334782                  1.821232    -0.672238   
5899                 2.047641                  2.595454    -0.672238   
5900                -1.763435                 -1.543678    -0.672238   
5901                 1.495544                  1.995833    -0.672238   
5902                -0.142658                  0.216614    -0.672238   
5903                -0.490399                 -0.161060    -0.672238   
5904                -0.763410                 -0.457572     0.281382   

      nd_C1_normal  nd_C2_fraud  nd_C2_normal  nd_C6_fraud  nd_C6_normal  \
0        -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
1         0.104134    -0.670399     -0.585029    -0.475686     -0.410116   
2        -0.286952    -0.957026     -0.098785    -0.893332     -0.205270   
3        -0.191785     0.317777      0.145844     0.130028      0.017531   
4         3.804434     5.455968      3.946140     5.677634      3.934259   
5         3.761268     5.130554      3.705458     5.259970      3.639379   
6         0.104134    -0.092353     -0.157496     0.130028      0.017531   
7        -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
8        -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
9        -0.191785    -0.670399     -0.585029    -0.475686     -0.410116   
10        0.521207     1.115586      0.735917     1.165502      0.748598   
11       -0.286952    -0.781781      0.195667    -0.493837      0.335431   
12       -0.608858    -0.092353     -0.157496     0.130028      0.017531   
13       -0.608858    -0.092353     -0.157496    -0.475686     -0.410116   
14       -0.608858    -0.670399     -0.585029    -1.511160     -1.141183   
15       -0.191785    -0.670399     -0.585029    -0.475686     -0.410116   
16       -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
17       -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
18       -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
19       -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
20       -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
21        0.333665     0.635898      0.381132    -0.475686     -0.410116   
22       -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
23        0.207788    -0.781781      0.195667    -0.893332     -0.205270   
24        0.207788    -0.781781      0.195667    -0.893332     -0.205270   
25        0.104134     0.317777      0.145844     0.893136      0.556302   
26       -0.608858    -0.092353     -0.157496     0.130028      0.017531   
27        0.104134    -0.670399     -0.585029    -0.475686     -0.410116   
28       -0.608858    -0.670399     -0.585029     0.893136      0.556302   
29       -0.608858    -0.092353     -0.157496    -0.475686     -0.410116   
...            ...          ...           ...          ...           ...   
5875      1.989180     2.872175      2.035121     2.887459      1.964336   
5876      5.470463     1.790811      4.518236     2.007758      3.721236   
5877     -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
5878     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5879     -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
5880     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5881     -0.286952    -1.204019     -0.513793    -0.893332     -0.205270   
5882     -0.191785     0.895823      0.573376     0.893136      0.556302   
5883     -0.286952    -1.204019     -0.513793    -0.493837      0.335431   
5884     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5885     -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
5886     -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
5887     -0.309434    -0.640895     -0.217957    -0.481202     -0.202963   
5888     -0.191785    -0.670399     -0.585029    -0.475686     -0.410116   
5889     -0.191785    -0.670399     -0.585029     0.559788      0.320951   
5890     -0.608858    -0.092353     -0.157496    -0.475686     -0.410116   
5891     -0.608858    -0.670399     -0.585029    -1.511160     -1.141183   
5892      0.333665     0.317777      0.145844     1.165502      0.748598   
5893     -0.608858    -0.670399     -0.585029     0.130028      0.017531   
5894      0.207788    -0.165554      1.231076    -0.893332     -0.205270   
5895      1.048071     0.783132      1.775788    -0.301511     -0.134553   
5896     -0.191785    -0.670399     -0.585029    -0.475686     -0.410116   
5897     -0.191785    -0.092353     -0.157496     0.130028      0.017531   
5898     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5899     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5900     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5901     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5902     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5903     -0.608858    -0.670399     -0.585029    -0.475686     -0.410116   
5904      0.104134    -0.670399     -0.585029     0.130028      0.017531   

      nd_C11_fraud  nd_C11_normal  nd_C13_fraud  nd_C13_normal  nd_C14_fraud  \
0        -0.468330      -0.468818     -1.219901      -1.417207     -1.369724   
1         0.188385      -0.011909     -0.119599      -0.460000     -0.356199   
2        -1.032901      -0.286967     -0.405600      -0.278449     -0.255669   
3         0.188385      -0.011909      1.624340       1.057136     -0.356199   
4         5.883932       3.950753      3.816634       2.964319      5.568349   
5         5.899889       3.961856      3.581776       2.760004      5.363988   
6         0.654332       0.312272      0.324569      -0.073598      0.657325   
7        -0.590531      -0.221319     -0.629002      -1.729233     -0.670258   
8        -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
9        -0.468330      -0.468818     -0.347932      -0.658639      0.236675   
10        1.015749       0.563727      1.334922       0.805358      1.250199   
11       -0.724316       0.225499     -0.405600      -0.278449     -0.255669   
12        0.188385      -0.011909     -0.669750      -0.938603     -0.356199   
13       -0.468330      -0.468818      1.396006       0.858498     -0.356199   
14       -0.468330      -0.468818      0.202219      -0.180035     -0.356199   
15       -0.468330      -0.468818     -0.347932      -0.658639      0.236675   
16       -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
17       -0.590531      -0.221319     -0.629002      -1.729233     -0.670258   
18       -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
19       -0.468330      -0.468818      0.202219      -0.180035     -0.356199   
20       -0.468330      -0.468818      0.874720       0.405006     -0.356199   
21       -0.468330      -0.468818      1.396006       0.858498      0.983607   
22       -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
23       -0.724316       0.225499     -0.405600      -0.278449     -0.255669   
24       -1.032901      -0.286967     -0.405600      -0.278449     -0.255669   
25       -0.468330      -0.468818      0.524037       0.099930      0.657325   
26       -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
27       -0.468330      -0.468818      1.396006       0.858498      0.657325   
28       -0.468330      -0.468818      0.607662       0.172679     -0.356199   
29       -0.468330      -0.468818     -0.347932      -0.658639     -0.356199   
...            ...            ...           ...            ...           ...   
5875      3.340098       2.180887      2.196238       1.554658      3.010657   
5876      1.683746       4.224551      1.474229       1.891059      1.807367   
5877     -0.590531      -0.221319      0.572203       0.413196      0.708017   
5878     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5879     -0.590531      -0.221319      0.572203       0.413196      0.708017   
5880     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5881     -1.032901      -0.286967     -0.405600      -0.278449     -0.255669   
5882      0.654332       0.312272      0.683310       0.238488      0.236675   
5883     -1.032901      -0.286967     -0.013904       0.173607     -0.255669   
5884     -0.468330      -0.468818     -0.347932      -0.658639     -0.356199   
5885     -0.590531      -0.221319      0.572203       0.413196      0.708017   
5886     -0.590531      -0.221319      0.572203       0.413196      0.708017   
5887     -0.590531      -0.221319     -0.629002      -1.729233     -0.670258   
5888     -0.468330      -0.468818      3.549298       2.731750     -0.356199   
5889     -0.468330      -0.468818      0.607662       0.172679      0.236675   
5890     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5891     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5892      0.654332       0.312272      0.752371       0.298568      0.983607   
5893     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5894     -0.724316       0.225499      0.479575       0.743129      0.235013   
5895      0.452816       1.258122      0.613866       0.781591      0.662335   
5896      0.188385      -0.011909     -0.669750      -0.938603     -0.356199   
5897     -0.468330      -0.468818      0.929480       0.452644      0.236675   
5898     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5899     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5900     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5901     -0.468330      -0.468818     -0.669750      -0.938603     -0.356199   
5902     -0.468330      -0.468818      0.929480       0.452644     -0.356199   
5903     -0.468330      -0.468818     -0.119599      -0.460000     -0.356199   
5904     -0.468330      -0.468818      0.202219      -0.180035      0.657325   

      nd_C14_normal  
0         -1.269720  
1         -0.533577  
2         -0.109273  
3         -0.533577  
4          3.769544  
5          3.621113  
6          0.202567  
7         -1.784973  
8         -0.533577  
9         -0.102960  
10         0.633184  
11        -0.109273  
12        -0.533577  
13        -0.533577  
14        -0.533577  
15        -0.102960  
16        -0.533577  
17        -1.784973  
18        -0.533577  
19        -0.533577  
20        -0.533577  
21         0.439552  
22        -0.533577  
23        -0.109273  
24        -0.109273  
25         0.202567  
26        -0.533577  
27         0.202567  
28        -0.533577  
29        -0.533577  
...             ...  
5875       1.911840  
5876       2.290049  
5877       0.479974  
5878      -0.533577  
5879       0.479974  
5880      -0.533577  
5881      -0.109273  
5882      -0.102960  
5883      -0.109273  
5884      -0.533577  
5885       0.479974  
5886       0.479974  
5887      -1.784973  
5888      -0.533577  
5889      -0.102960  
5890      -0.533577  
5891      -0.533577  
5892       0.439552  
5893      -0.533577  
5894       0.461393  
5895       1.210891  
5896      -0.533577  
5897      -0.102960  
5898      -0.533577  
5899      -0.533577  
5900      -0.533577  
5901      -0.533577  
5902      -0.533577  
5903      -0.533577  
5904       0.202567  

[5905 rows x 14 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  nd_TransactionAmt_fraud  nd_TransactionAmt_normal  \
0            W                -0.059625                  0.306795   
1            W                -0.059625                  0.306795   
2            C                -0.513741                 -0.465926   
3            W                -0.763410                 -0.457572   
4            W                -0.854520                 -0.556525   
5            W                -1.419155                 -1.169763   
6            W                 0.955314                  1.409100   
7            H                 0.020170                  0.940693   
8            W                -1.594321                 -1.360007   
9            W                -0.059625                  0.306795   
10           W                -1.267861                 -1.005446   
11           C                -0.118172                 -0.065970   
12           W                -1.062766                 -0.782696   
13           W                -0.781782                 -0.477525   
14           W                -0.932524                 -0.641243   
15           W                -0.059625                  0.306795   
16           W                 2.609049                  3.205189   
17           H                -1.091406                 -0.995048   
18           W                -1.653799                 -1.424605   
19           W                -1.185329                 -0.915809   
20           W                -0.490399                 -0.161060   
21           W                -0.781782                 -0.477525   
22           W                -1.051268                 -0.770208   
23           C                 0.571394                  0.631242   
24           C                 0.261553                  0.317966   
25           W                 0.746297                  1.182090   
26           W                 1.146169                  1.616384   
27           W                 0.263381                  0.657605   
28           W                -0.059625                  0.306795   
29           W                -0.781782                 -0.477525   
...        ...                      ...                       ...   
5875         W                -0.242839                  0.107810   
5876         C                -0.841892                 -0.797716   
5877         H                -0.622886                 -0.179148   
5878         W                -1.596250                 -1.362102   
5879         H                -1.256939                 -1.283312   
5880         W                 2.409559                  2.988527   
5881         C                 0.519357                  0.578629   
5882         W                 1.323965                  1.809485   
5883         C                -0.303956                 -0.253814   
5884         W                -0.059625                  0.306795   
5885         H                 0.398646                  1.599786   
5886         H                -1.256939                 -1.283312   
5887         H                -0.622886                 -0.179148   
5888         W                -1.086151                 -0.808094   
5889         W                -1.484685                 -1.240934   
5890         W                -0.142658                  0.216614   
5891         W                -1.051268                 -0.770208   
5892         W                -0.932524                 -0.641243   
5893         W                -0.451128                 -0.118408   
5894         C                -0.170747                 -0.119128   
5895         S                 0.342608                  0.223026   
5896         W                 1.160054                  1.631464   
5897         W                -0.912318                 -0.619298   
5898         W                 1.334782                  1.821232   
5899         W                 2.047641                  2.595454   
5900         W                -1.763435                 -1.543678   
5901         W                 1.495544                  1.995833   
5902         W                -0.142658                  0.216614   
5903         W                -0.490399                 -0.161060   
5904         W                -0.763410                 -0.457572   

      nd_C1_fraud  nd_C1_normal  nd_C2_fraud  nd_C2_normal  nd_C6_fraud  \
0       -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
1        0.281382      0.104134    -0.670399     -0.585029    -0.475686   
2       -1.148647     -0.286952    -0.957026     -0.098785    -0.893332   
3       -0.114406     -0.191785     0.317777      0.145844     0.130028   
4        5.230499      3.804434     5.455968      3.946140     5.677634   
5        5.172766      3.761268     5.130554      3.705458     5.259970   
6        0.281382      0.104134    -0.092353     -0.157496     0.130028   
7       -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
8       -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
9       -0.114406     -0.191785    -0.670399     -0.585029    -0.475686   
10       0.839213      0.521207     1.115586      0.735917     1.165502   
11      -1.148647     -0.286952    -0.781781      0.195667    -0.493837   
12      -0.672238     -0.608858    -0.092353     -0.157496     0.130028   
13      -0.672238     -0.608858    -0.092353     -0.157496    -0.475686   
14      -0.672238     -0.608858    -0.670399     -0.585029    -1.511160   
15      -0.114406     -0.191785    -0.670399     -0.585029    -0.475686   
16      -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
17      -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
18      -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
19      -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
20      -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
21       0.588379      0.333665     0.635898      0.381132    -0.475686   
22      -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
23      -0.889462      0.207788    -0.781781      0.195667    -0.893332   
24      -0.889462      0.207788    -0.781781      0.195667    -0.893332   
25       0.281382      0.104134     0.317777      0.145844     0.893136   
26      -0.672238     -0.608858    -0.092353     -0.157496     0.130028   
27       0.281382      0.104134    -0.670399     -0.585029    -0.475686   
28      -0.672238     -0.608858    -0.670399     -0.585029     0.893136   
29      -0.672238     -0.608858    -0.092353     -0.157496    -0.475686   
...           ...           ...          ...           ...          ...   
5875     2.802614      1.989180     2.872175      2.035121     2.887459   
5876     1.867560      5.470463     1.790811      4.518236     2.007758   
5877    -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
5878    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5879    -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
5880    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5881    -1.148647     -0.286952    -1.204019     -0.513793    -0.893332   
5882    -0.114406     -0.191785     0.895823      0.573376     0.893136   
5883    -1.148647     -0.286952    -1.204019     -0.513793    -0.493837   
5884    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5885    -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
5886    -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
5887    -0.629921     -0.309434    -0.640895     -0.217957    -0.481202   
5888    -0.114406     -0.191785    -0.670399     -0.585029    -0.475686   
5889    -0.114406     -0.191785    -0.670399     -0.585029     0.559788   
5890    -0.672238     -0.608858    -0.092353     -0.157496    -0.475686   
5891    -0.672238     -0.608858    -0.670399     -0.585029    -1.511160   
5892     0.588379      0.333665     0.317777      0.145844     1.165502   
5893    -0.672238     -0.608858    -0.670399     -0.585029     0.130028   
5894    -0.889462      0.207788    -0.165554      1.231076    -0.893332   
5895    -0.176438      1.048071     0.783132      1.775788    -0.301511   
5896    -0.114406     -0.191785    -0.670399     -0.585029    -0.475686   
5897    -0.114406     -0.191785    -0.092353     -0.157496     0.130028   
5898    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5899    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5900    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5901    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5902    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5903    -0.672238     -0.608858    -0.670399     -0.585029    -0.475686   
5904     0.281382      0.104134    -0.670399     -0.585029     0.130028   

      nd_C6_normal  nd_C11_fraud  nd_C11_normal  nd_C13_fraud  nd_C13_normal  \
0        -0.410116     -0.468330      -0.468818     -1.219901      -1.417207   
1        -0.410116      0.188385      -0.011909     -0.119599      -0.460000   
2        -0.205270     -1.032901      -0.286967     -0.405600      -0.278449   
3         0.017531      0.188385      -0.011909      1.624340       1.057136   
4         3.934259      5.883932       3.950753      3.816634       2.964319   
5         3.639379      5.899889       3.961856      3.581776       2.760004   
6         0.017531      0.654332       0.312272      0.324569      -0.073598   
7        -0.202963     -0.590531      -0.221319     -0.629002      -1.729233   
8        -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
9        -0.410116     -0.468330      -0.468818     -0.347932      -0.658639   
10        0.748598      1.015749       0.563727      1.334922       0.805358   
11        0.335431     -0.724316       0.225499     -0.405600      -0.278449   
12        0.017531      0.188385      -0.011909     -0.669750      -0.938603   
13       -0.410116     -0.468330      -0.468818      1.396006       0.858498   
14       -1.141183     -0.468330      -0.468818      0.202219      -0.180035   
15       -0.410116     -0.468330      -0.468818     -0.347932      -0.658639   
16       -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
17       -0.202963     -0.590531      -0.221319     -0.629002      -1.729233   
18       -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
19       -0.410116     -0.468330      -0.468818      0.202219      -0.180035   
20       -0.410116     -0.468330      -0.468818      0.874720       0.405006   
21       -0.410116     -0.468330      -0.468818      1.396006       0.858498   
22       -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
23       -0.205270     -0.724316       0.225499     -0.405600      -0.278449   
24       -0.205270     -1.032901      -0.286967     -0.405600      -0.278449   
25        0.556302     -0.468330      -0.468818      0.524037       0.099930   
26        0.017531     -0.468330      -0.468818     -0.669750      -0.938603   
27       -0.410116     -0.468330      -0.468818      1.396006       0.858498   
28        0.556302     -0.468330      -0.468818      0.607662       0.172679   
29       -0.410116     -0.468330      -0.468818     -0.347932      -0.658639   
...            ...           ...            ...           ...            ...   
5875      1.964336      3.340098       2.180887      2.196238       1.554658   
5876      3.721236      1.683746       4.224551      1.474229       1.891059   
5877     -0.202963     -0.590531      -0.221319      0.572203       0.413196   
5878     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5879     -0.202963     -0.590531      -0.221319      0.572203       0.413196   
5880     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5881     -0.205270     -1.032901      -0.286967     -0.405600      -0.278449   
5882      0.556302      0.654332       0.312272      0.683310       0.238488   
5883      0.335431     -1.032901      -0.286967     -0.013904       0.173607   
5884     -0.410116     -0.468330      -0.468818     -0.347932      -0.658639   
5885     -0.202963     -0.590531      -0.221319      0.572203       0.413196   
5886     -0.202963     -0.590531      -0.221319      0.572203       0.413196   
5887     -0.202963     -0.590531      -0.221319     -0.629002      -1.729233   
5888     -0.410116     -0.468330      -0.468818      3.549298       2.731750   
5889      0.320951     -0.468330      -0.468818      0.607662       0.172679   
5890     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5891     -1.141183     -0.468330      -0.468818     -0.669750      -0.938603   
5892      0.748598      0.654332       0.312272      0.752371       0.298568   
5893      0.017531     -0.468330      -0.468818     -0.669750      -0.938603   
5894     -0.205270     -0.724316       0.225499      0.479575       0.743129   
5895     -0.134553      0.452816       1.258122      0.613866       0.781591   
5896     -0.410116      0.188385      -0.011909     -0.669750      -0.938603   
5897      0.017531     -0.468330      -0.468818      0.929480       0.452644   
5898     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5899     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5900     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5901     -0.410116     -0.468330      -0.468818     -0.669750      -0.938603   
5902     -0.410116     -0.468330      -0.468818      0.929480       0.452644   
5903     -0.410116     -0.468330      -0.468818     -0.119599      -0.460000   
5904      0.017531     -0.468330      -0.468818      0.202219      -0.180035   

      nd_C14_fraud  nd_C14_normal  
0        -1.369724      -1.269720  
1        -0.356199      -0.533577  
2        -0.255669      -0.109273  
3        -0.356199      -0.533577  
4         5.568349       3.769544  
5         5.363988       3.621113  
6         0.657325       0.202567  
7        -0.670258      -1.784973  
8        -0.356199      -0.533577  
9         0.236675      -0.102960  
10        1.250199       0.633184  
11       -0.255669      -0.109273  
12       -0.356199      -0.533577  
13       -0.356199      -0.533577  
14       -0.356199      -0.533577  
15        0.236675      -0.102960  
16       -0.356199      -0.533577  
17       -0.670258      -1.784973  
18       -0.356199      -0.533577  
19       -0.356199      -0.533577  
20       -0.356199      -0.533577  
21        0.983607       0.439552  
22       -0.356199      -0.533577  
23       -0.255669      -0.109273  
24       -0.255669      -0.109273  
25        0.657325       0.202567  
26       -0.356199      -0.533577  
27        0.657325       0.202567  
28       -0.356199      -0.533577  
29       -0.356199      -0.533577  
...            ...            ...  
5875      3.010657       1.911840  
5876      1.807367       2.290049  
5877      0.708017       0.479974  
5878     -0.356199      -0.533577  
5879      0.708017       0.479974  
5880     -0.356199      -0.533577  
5881     -0.255669      -0.109273  
5882      0.236675      -0.102960  
5883     -0.255669      -0.109273  
5884     -0.356199      -0.533577  
5885      0.708017       0.479974  
5886      0.708017       0.479974  
5887     -0.670258      -1.784973  
5888     -0.356199      -0.533577  
5889      0.236675      -0.102960  
5890     -0.356199      -0.533577  
5891     -0.356199      -0.533577  
5892      0.983607       0.439552  
5893     -0.356199      -0.533577  
5894      0.235013       0.461393  
5895      0.662335       1.210891  
5896     -0.356199      -0.533577  
5897      0.236675      -0.102960  
5898     -0.356199      -0.533577  
5899     -0.356199      -0.533577  
5900     -0.356199      -0.533577  
5901     -0.356199      -0.533577  
5902     -0.356199      -0.533577  
5903     -0.356199      -0.533577  
5904      0.657325       0.202567  

[5905 rows x 15 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  TransactionAmt  nd_TransactionAmt_fraud  \
0            W         117.000                -0.059625   
1            W         117.000                -0.059625   
2            C          22.235                -0.513741   
3            W          59.000                -0.763410   
4            W          53.970                -0.854520   
5            W          30.950                -1.419155   
6            W         311.950                 0.955314   
7            H         100.000                 0.020170   
8            W          26.000                -1.594321   
9            W         117.000                -0.059625   
10           W          35.950                -1.267861   
11           C          30.782                -0.118172   
12           W          44.000                -1.062766   
13           W          57.950                -0.781782   
14           W          50.000                -0.932524   
15           W         117.000                -0.059625   
16           W        1532.470                 2.609049   
17           H          30.000                -1.091406   
18           W          24.500                -1.653799   
19           W          39.000                -1.185329   
20           W          77.000                -0.490399   
21           W          57.950                -0.781782   
22           W          44.500                -1.051268   
23           C          53.869                 0.571394   
24           C          41.931                 0.261553   
25           W         255.000                 0.746297   
26           W         374.950                 1.146169   
27           W         159.950                 0.263381   
28           W         117.000                -0.059625   
29           W          57.950                -0.781782   
...        ...             ...                      ...   
5875         W          97.950                -0.242839   
5876         C          16.918                -0.841892   
5877         H          50.000                -0.622886   
5878         W          25.950                -1.596250   
5879         H          25.000                -1.256939   
5880         W        1264.950                 2.409559   
5881         C          51.654                 0.519357   
5882         W         445.000                 1.323965   
5883         C          26.434                -0.303956   
5884         W         117.000                -0.059625   
5885         H         150.000                 0.398646   
5886         H          25.000                -1.256939   
5887         H          50.000                -0.622886   
5888         W          43.000                -1.086151   
5889         W          29.000                -1.484685   
5890         W         107.950                -0.142658   
5891         W          44.500                -1.051268   
5892         W          50.000                -0.932524   
5893         W          80.000                -0.451128   
5894         C          29.486                -0.170747   
5895         S          50.000                 0.342608   
5896         W         380.000                 1.160054   
5897         W          51.000                -0.912318   
5898         W         449.660                 1.334782   
5899         W         893.060                 2.047641   
5900         W          21.950                -1.763435   
5901         W         524.950                 1.495544   
5902         W         107.950                -0.142658   
5903         W          77.000                -0.490399   
5904         W          59.000                -0.763410   

      nd_TransactionAmt_normal  nd_C1_fraud  nd_C1_normal  nd_C2_fraud  \
0                     0.306795    -0.672238     -0.608858    -0.670399   
1                     0.306795     0.281382      0.104134    -0.670399   
2                    -0.465926    -1.148647     -0.286952    -0.957026   
3                    -0.457572    -0.114406     -0.191785     0.317777   
4                    -0.556525     5.230499      3.804434     5.455968   
5                    -1.169763     5.172766      3.761268     5.130554   
6                     1.409100     0.281382      0.104134    -0.092353   
7                     0.940693    -0.629921     -0.309434    -0.640895   
8                    -1.360007    -0.672238     -0.608858    -0.670399   
9                     0.306795    -0.114406     -0.191785    -0.670399   
10                   -1.005446     0.839213      0.521207     1.115586   
11                   -0.065970    -1.148647     -0.286952    -0.781781   
12                   -0.782696    -0.672238     -0.608858    -0.092353   
13                   -0.477525    -0.672238     -0.608858    -0.092353   
14                   -0.641243    -0.672238     -0.608858    -0.670399   
15                    0.306795    -0.114406     -0.191785    -0.670399   
16                    3.205189    -0.672238     -0.608858    -0.670399   
17                   -0.995048    -0.629921     -0.309434    -0.640895   
18                   -1.424605    -0.672238     -0.608858    -0.670399   
19                   -0.915809    -0.672238     -0.608858    -0.670399   
20                   -0.161060    -0.672238     -0.608858    -0.670399   
21                   -0.477525     0.588379      0.333665     0.635898   
22                   -0.770208    -0.672238     -0.608858    -0.670399   
23                    0.631242    -0.889462      0.207788    -0.781781   
24                    0.317966    -0.889462      0.207788    -0.781781   
25                    1.182090     0.281382      0.104134     0.317777   
26                    1.616384    -0.672238     -0.608858    -0.092353   
27                    0.657605     0.281382      0.104134    -0.670399   
28                    0.306795    -0.672238     -0.608858    -0.670399   
29                   -0.477525    -0.672238     -0.608858    -0.092353   
...                        ...          ...           ...          ...   
5875                  0.107810     2.802614      1.989180     2.872175   
5876                 -0.797716     1.867560      5.470463     1.790811   
5877                 -0.179148    -0.629921     -0.309434    -0.640895   
5878                 -1.362102    -0.672238     -0.608858    -0.670399   
5879                 -1.283312    -0.629921     -0.309434    -0.640895   
5880                  2.988527    -0.672238     -0.608858    -0.670399   
5881                  0.578629    -1.148647     -0.286952    -1.204019   
5882                  1.809485    -0.114406     -0.191785     0.895823   
5883                 -0.253814    -1.148647     -0.286952    -1.204019   
5884                  0.306795    -0.672238     -0.608858    -0.670399   
5885                  1.599786    -0.629921     -0.309434    -0.640895   
5886                 -1.283312    -0.629921     -0.309434    -0.640895   
5887                 -0.179148    -0.629921     -0.309434    -0.640895   
5888                 -0.808094    -0.114406     -0.191785    -0.670399   
5889                 -1.240934    -0.114406     -0.191785    -0.670399   
5890                  0.216614    -0.672238     -0.608858    -0.092353   
5891                 -0.770208    -0.672238     -0.608858    -0.670399   
5892                 -0.641243     0.588379      0.333665     0.317777   
5893                 -0.118408    -0.672238     -0.608858    -0.670399   
5894                 -0.119128    -0.889462      0.207788    -0.165554   
5895                  0.223026    -0.176438      1.048071     0.783132   
5896                  1.631464    -0.114406     -0.191785    -0.670399   
5897                 -0.619298    -0.114406     -0.191785    -0.092353   
5898                  1.821232    -0.672238     -0.608858    -0.670399   
5899                  2.595454    -0.672238     -0.608858    -0.670399   
5900                 -1.543678    -0.672238     -0.608858    -0.670399   
5901                  1.995833    -0.672238     -0.608858    -0.670399   
5902                  0.216614    -0.672238     -0.608858    -0.670399   
5903                 -0.161060    -0.672238     -0.608858    -0.670399   
5904                 -0.457572     0.281382      0.104134    -0.670399   

      nd_C2_normal  nd_C6_fraud  nd_C6_normal  nd_C11_fraud  nd_C11_normal  \
0        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1        -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
2        -0.098785    -0.893332     -0.205270     -1.032901      -0.286967   
3         0.145844     0.130028      0.017531      0.188385      -0.011909   
4         3.946140     5.677634      3.934259      5.883932       3.950753   
5         3.705458     5.259970      3.639379      5.899889       3.961856   
6        -0.157496     0.130028      0.017531      0.654332       0.312272   
7        -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
8        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
9        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
10        0.735917     1.165502      0.748598      1.015749       0.563727   
11        0.195667    -0.493837      0.335431     -0.724316       0.225499   
12       -0.157496     0.130028      0.017531      0.188385      -0.011909   
13       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
14       -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
15       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
16       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
17       -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
18       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
19       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
20       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
21        0.381132    -0.475686     -0.410116     -0.468330      -0.468818   
22       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
23        0.195667    -0.893332     -0.205270     -0.724316       0.225499   
24        0.195667    -0.893332     -0.205270     -1.032901      -0.286967   
25        0.145844     0.893136      0.556302     -0.468330      -0.468818   
26       -0.157496     0.130028      0.017531     -0.468330      -0.468818   
27       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
28       -0.585029     0.893136      0.556302     -0.468330      -0.468818   
29       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
...            ...          ...           ...           ...            ...   
5875      2.035121     2.887459      1.964336      3.340098       2.180887   
5876      4.518236     2.007758      3.721236      1.683746       4.224551   
5877     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5878     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5879     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5880     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5881     -0.513793    -0.893332     -0.205270     -1.032901      -0.286967   
5882      0.573376     0.893136      0.556302      0.654332       0.312272   
5883     -0.513793    -0.493837      0.335431     -1.032901      -0.286967   
5884     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5885     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5886     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5887     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5888     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5889     -0.585029     0.559788      0.320951     -0.468330      -0.468818   
5890     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
5891     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
5892      0.145844     1.165502      0.748598      0.654332       0.312272   
5893     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
5894      1.231076    -0.893332     -0.205270     -0.724316       0.225499   
5895      1.775788    -0.301511     -0.134553      0.452816       1.258122   
5896     -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
5897     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
5898     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5899     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5900     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5901     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5902     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5903     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5904     -0.585029     0.130028      0.017531     -0.468330      -0.468818   

      nd_C13_fraud  nd_C13_normal  nd_C14_fraud  nd_C14_normal  
0        -1.219901      -1.417207     -1.369724      -1.269720  
1        -0.119599      -0.460000     -0.356199      -0.533577  
2        -0.405600      -0.278449     -0.255669      -0.109273  
3         1.624340       1.057136     -0.356199      -0.533577  
4         3.816634       2.964319      5.568349       3.769544  
5         3.581776       2.760004      5.363988       3.621113  
6         0.324569      -0.073598      0.657325       0.202567  
7        -0.629002      -1.729233     -0.670258      -1.784973  
8        -0.669750      -0.938603     -0.356199      -0.533577  
9        -0.347932      -0.658639      0.236675      -0.102960  
10        1.334922       0.805358      1.250199       0.633184  
11       -0.405600      -0.278449     -0.255669      -0.109273  
12       -0.669750      -0.938603     -0.356199      -0.533577  
13        1.396006       0.858498     -0.356199      -0.533577  
14        0.202219      -0.180035     -0.356199      -0.533577  
15       -0.347932      -0.658639      0.236675      -0.102960  
16       -0.669750      -0.938603     -0.356199      -0.533577  
17       -0.629002      -1.729233     -0.670258      -1.784973  
18       -0.669750      -0.938603     -0.356199      -0.533577  
19        0.202219      -0.180035     -0.356199      -0.533577  
20        0.874720       0.405006     -0.356199      -0.533577  
21        1.396006       0.858498      0.983607       0.439552  
22       -0.669750      -0.938603     -0.356199      -0.533577  
23       -0.405600      -0.278449     -0.255669      -0.109273  
24       -0.405600      -0.278449     -0.255669      -0.109273  
25        0.524037       0.099930      0.657325       0.202567  
26       -0.669750      -0.938603     -0.356199      -0.533577  
27        1.396006       0.858498      0.657325       0.202567  
28        0.607662       0.172679     -0.356199      -0.533577  
29       -0.347932      -0.658639     -0.356199      -0.533577  
...            ...            ...           ...            ...  
5875      2.196238       1.554658      3.010657       1.911840  
5876      1.474229       1.891059      1.807367       2.290049  
5877      0.572203       0.413196      0.708017       0.479974  
5878     -0.669750      -0.938603     -0.356199      -0.533577  
5879      0.572203       0.413196      0.708017       0.479974  
5880     -0.669750      -0.938603     -0.356199      -0.533577  
5881     -0.405600      -0.278449     -0.255669      -0.109273  
5882      0.683310       0.238488      0.236675      -0.102960  
5883     -0.013904       0.173607     -0.255669      -0.109273  
5884     -0.347932      -0.658639     -0.356199      -0.533577  
5885      0.572203       0.413196      0.708017       0.479974  
5886      0.572203       0.413196      0.708017       0.479974  
5887     -0.629002      -1.729233     -0.670258      -1.784973  
5888      3.549298       2.731750     -0.356199      -0.533577  
5889      0.607662       0.172679      0.236675      -0.102960  
5890     -0.669750      -0.938603     -0.356199      -0.533577  
5891     -0.669750      -0.938603     -0.356199      -0.533577  
5892      0.752371       0.298568      0.983607       0.439552  
5893     -0.669750      -0.938603     -0.356199      -0.533577  
5894      0.479575       0.743129      0.235013       0.461393  
5895      0.613866       0.781591      0.662335       1.210891  
5896     -0.669750      -0.938603     -0.356199      -0.533577  
5897      0.929480       0.452644      0.236675      -0.102960  
5898     -0.669750      -0.938603     -0.356199      -0.533577  
5899     -0.669750      -0.938603     -0.356199      -0.533577  
5900     -0.669750      -0.938603     -0.356199      -0.533577  
5901     -0.669750      -0.938603     -0.356199      -0.533577  
5902      0.929480       0.452644     -0.356199      -0.533577  
5903     -0.119599      -0.460000     -0.356199      -0.533577  
5904      0.202219      -0.180035      0.657325       0.202567  

[5905 rows x 16 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  TransactionAmt  isFraud  nd_TransactionAmt_fraud  \
0            W         117.000        0                -0.059625   
1            W         117.000        0                -0.059625   
2            C          22.235        0                -0.513741   
3            W          59.000        0                -0.763410   
4            W          53.970        0                -0.854520   
5            W          30.950        0                -1.419155   
6            W         311.950        0                 0.955314   
7            H         100.000        0                 0.020170   
8            W          26.000        0                -1.594321   
9            W         117.000        0                -0.059625   
10           W          35.950        0                -1.267861   
11           C          30.782        0                -0.118172   
12           W          44.000        0                -1.062766   
13           W          57.950        0                -0.781782   
14           W          50.000        0                -0.932524   
15           W         117.000        0                -0.059625   
16           W        1532.470        0                 2.609049   
17           H          30.000        0                -1.091406   
18           W          24.500        0                -1.653799   
19           W          39.000        0                -1.185329   
20           W          77.000        0                -0.490399   
21           W          57.950        0                -0.781782   
22           W          44.500        0                -1.051268   
23           C          53.869        0                 0.571394   
24           C          41.931        0                 0.261553   
25           W         255.000        0                 0.746297   
26           W         374.950        0                 1.146169   
27           W         159.950        0                 0.263381   
28           W         117.000        0                -0.059625   
29           W          57.950        0                -0.781782   
...        ...             ...      ...                      ...   
5875         W          97.950        0                -0.242839   
5876         C          16.918        1                -0.841892   
5877         H          50.000        0                -0.622886   
5878         W          25.950        0                -1.596250   
5879         H          25.000        0                -1.256939   
5880         W        1264.950        0                 2.409559   
5881         C          51.654        0                 0.519357   
5882         W         445.000        0                 1.323965   
5883         C          26.434        0                -0.303956   
5884         W         117.000        0                -0.059625   
5885         H         150.000        0                 0.398646   
5886         H          25.000        0                -1.256939   
5887         H          50.000        0                -0.622886   
5888         W          43.000        0                -1.086151   
5889         W          29.000        0                -1.484685   
5890         W         107.950        0                -0.142658   
5891         W          44.500        0                -1.051268   
5892         W          50.000        0                -0.932524   
5893         W          80.000        0                -0.451128   
5894         C          29.486        0                -0.170747   
5895         S          50.000        0                 0.342608   
5896         W         380.000        0                 1.160054   
5897         W          51.000        0                -0.912318   
5898         W         449.660        0                 1.334782   
5899         W         893.060        0                 2.047641   
5900         W          21.950        0                -1.763435   
5901         W         524.950        0                 1.495544   
5902         W         107.950        0                -0.142658   
5903         W          77.000        0                -0.490399   
5904         W          59.000        0                -0.763410   

      nd_TransactionAmt_normal  nd_C1_fraud  nd_C1_normal  nd_C2_fraud  \
0                     0.306795    -0.672238     -0.608858    -0.670399   
1                     0.306795     0.281382      0.104134    -0.670399   
2                    -0.465926    -1.148647     -0.286952    -0.957026   
3                    -0.457572    -0.114406     -0.191785     0.317777   
4                    -0.556525     5.230499      3.804434     5.455968   
5                    -1.169763     5.172766      3.761268     5.130554   
6                     1.409100     0.281382      0.104134    -0.092353   
7                     0.940693    -0.629921     -0.309434    -0.640895   
8                    -1.360007    -0.672238     -0.608858    -0.670399   
9                     0.306795    -0.114406     -0.191785    -0.670399   
10                   -1.005446     0.839213      0.521207     1.115586   
11                   -0.065970    -1.148647     -0.286952    -0.781781   
12                   -0.782696    -0.672238     -0.608858    -0.092353   
13                   -0.477525    -0.672238     -0.608858    -0.092353   
14                   -0.641243    -0.672238     -0.608858    -0.670399   
15                    0.306795    -0.114406     -0.191785    -0.670399   
16                    3.205189    -0.672238     -0.608858    -0.670399   
17                   -0.995048    -0.629921     -0.309434    -0.640895   
18                   -1.424605    -0.672238     -0.608858    -0.670399   
19                   -0.915809    -0.672238     -0.608858    -0.670399   
20                   -0.161060    -0.672238     -0.608858    -0.670399   
21                   -0.477525     0.588379      0.333665     0.635898   
22                   -0.770208    -0.672238     -0.608858    -0.670399   
23                    0.631242    -0.889462      0.207788    -0.781781   
24                    0.317966    -0.889462      0.207788    -0.781781   
25                    1.182090     0.281382      0.104134     0.317777   
26                    1.616384    -0.672238     -0.608858    -0.092353   
27                    0.657605     0.281382      0.104134    -0.670399   
28                    0.306795    -0.672238     -0.608858    -0.670399   
29                   -0.477525    -0.672238     -0.608858    -0.092353   
...                        ...          ...           ...          ...   
5875                  0.107810     2.802614      1.989180     2.872175   
5876                 -0.797716     1.867560      5.470463     1.790811   
5877                 -0.179148    -0.629921     -0.309434    -0.640895   
5878                 -1.362102    -0.672238     -0.608858    -0.670399   
5879                 -1.283312    -0.629921     -0.309434    -0.640895   
5880                  2.988527    -0.672238     -0.608858    -0.670399   
5881                  0.578629    -1.148647     -0.286952    -1.204019   
5882                  1.809485    -0.114406     -0.191785     0.895823   
5883                 -0.253814    -1.148647     -0.286952    -1.204019   
5884                  0.306795    -0.672238     -0.608858    -0.670399   
5885                  1.599786    -0.629921     -0.309434    -0.640895   
5886                 -1.283312    -0.629921     -0.309434    -0.640895   
5887                 -0.179148    -0.629921     -0.309434    -0.640895   
5888                 -0.808094    -0.114406     -0.191785    -0.670399   
5889                 -1.240934    -0.114406     -0.191785    -0.670399   
5890                  0.216614    -0.672238     -0.608858    -0.092353   
5891                 -0.770208    -0.672238     -0.608858    -0.670399   
5892                 -0.641243     0.588379      0.333665     0.317777   
5893                 -0.118408    -0.672238     -0.608858    -0.670399   
5894                 -0.119128    -0.889462      0.207788    -0.165554   
5895                  0.223026    -0.176438      1.048071     0.783132   
5896                  1.631464    -0.114406     -0.191785    -0.670399   
5897                 -0.619298    -0.114406     -0.191785    -0.092353   
5898                  1.821232    -0.672238     -0.608858    -0.670399   
5899                  2.595454    -0.672238     -0.608858    -0.670399   
5900                 -1.543678    -0.672238     -0.608858    -0.670399   
5901                  1.995833    -0.672238     -0.608858    -0.670399   
5902                  0.216614    -0.672238     -0.608858    -0.670399   
5903                 -0.161060    -0.672238     -0.608858    -0.670399   
5904                 -0.457572     0.281382      0.104134    -0.670399   

      nd_C2_normal  nd_C6_fraud  nd_C6_normal  nd_C11_fraud  nd_C11_normal  \
0        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1        -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
2        -0.098785    -0.893332     -0.205270     -1.032901      -0.286967   
3         0.145844     0.130028      0.017531      0.188385      -0.011909   
4         3.946140     5.677634      3.934259      5.883932       3.950753   
5         3.705458     5.259970      3.639379      5.899889       3.961856   
6        -0.157496     0.130028      0.017531      0.654332       0.312272   
7        -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
8        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
9        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
10        0.735917     1.165502      0.748598      1.015749       0.563727   
11        0.195667    -0.493837      0.335431     -0.724316       0.225499   
12       -0.157496     0.130028      0.017531      0.188385      -0.011909   
13       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
14       -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
15       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
16       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
17       -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
18       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
19       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
20       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
21        0.381132    -0.475686     -0.410116     -0.468330      -0.468818   
22       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
23        0.195667    -0.893332     -0.205270     -0.724316       0.225499   
24        0.195667    -0.893332     -0.205270     -1.032901      -0.286967   
25        0.145844     0.893136      0.556302     -0.468330      -0.468818   
26       -0.157496     0.130028      0.017531     -0.468330      -0.468818   
27       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
28       -0.585029     0.893136      0.556302     -0.468330      -0.468818   
29       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
...            ...          ...           ...           ...            ...   
5875      2.035121     2.887459      1.964336      3.340098       2.180887   
5876      4.518236     2.007758      3.721236      1.683746       4.224551   
5877     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5878     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5879     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5880     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5881     -0.513793    -0.893332     -0.205270     -1.032901      -0.286967   
5882      0.573376     0.893136      0.556302      0.654332       0.312272   
5883     -0.513793    -0.493837      0.335431     -1.032901      -0.286967   
5884     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5885     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5886     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5887     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5888     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5889     -0.585029     0.559788      0.320951     -0.468330      -0.468818   
5890     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
5891     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
5892      0.145844     1.165502      0.748598      0.654332       0.312272   
5893     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
5894      1.231076    -0.893332     -0.205270     -0.724316       0.225499   
5895      1.775788    -0.301511     -0.134553      0.452816       1.258122   
5896     -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
5897     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
5898     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5899     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5900     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5901     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5902     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5903     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5904     -0.585029     0.130028      0.017531     -0.468330      -0.468818   

      nd_C13_fraud  nd_C13_normal  nd_C14_fraud  nd_C14_normal  
0        -1.219901      -1.417207     -1.369724      -1.269720  
1        -0.119599      -0.460000     -0.356199      -0.533577  
2        -0.405600      -0.278449     -0.255669      -0.109273  
3         1.624340       1.057136     -0.356199      -0.533577  
4         3.816634       2.964319      5.568349       3.769544  
5         3.581776       2.760004      5.363988       3.621113  
6         0.324569      -0.073598      0.657325       0.202567  
7        -0.629002      -1.729233     -0.670258      -1.784973  
8        -0.669750      -0.938603     -0.356199      -0.533577  
9        -0.347932      -0.658639      0.236675      -0.102960  
10        1.334922       0.805358      1.250199       0.633184  
11       -0.405600      -0.278449     -0.255669      -0.109273  
12       -0.669750      -0.938603     -0.356199      -0.533577  
13        1.396006       0.858498     -0.356199      -0.533577  
14        0.202219      -0.180035     -0.356199      -0.533577  
15       -0.347932      -0.658639      0.236675      -0.102960  
16       -0.669750      -0.938603     -0.356199      -0.533577  
17       -0.629002      -1.729233     -0.670258      -1.784973  
18       -0.669750      -0.938603     -0.356199      -0.533577  
19        0.202219      -0.180035     -0.356199      -0.533577  
20        0.874720       0.405006     -0.356199      -0.533577  
21        1.396006       0.858498      0.983607       0.439552  
22       -0.669750      -0.938603     -0.356199      -0.533577  
23       -0.405600      -0.278449     -0.255669      -0.109273  
24       -0.405600      -0.278449     -0.255669      -0.109273  
25        0.524037       0.099930      0.657325       0.202567  
26       -0.669750      -0.938603     -0.356199      -0.533577  
27        1.396006       0.858498      0.657325       0.202567  
28        0.607662       0.172679     -0.356199      -0.533577  
29       -0.347932      -0.658639     -0.356199      -0.533577  
...            ...            ...           ...            ...  
5875      2.196238       1.554658      3.010657       1.911840  
5876      1.474229       1.891059      1.807367       2.290049  
5877      0.572203       0.413196      0.708017       0.479974  
5878     -0.669750      -0.938603     -0.356199      -0.533577  
5879      0.572203       0.413196      0.708017       0.479974  
5880     -0.669750      -0.938603     -0.356199      -0.533577  
5881     -0.405600      -0.278449     -0.255669      -0.109273  
5882      0.683310       0.238488      0.236675      -0.102960  
5883     -0.013904       0.173607     -0.255669      -0.109273  
5884     -0.347932      -0.658639     -0.356199      -0.533577  
5885      0.572203       0.413196      0.708017       0.479974  
5886      0.572203       0.413196      0.708017       0.479974  
5887     -0.629002      -1.729233     -0.670258      -1.784973  
5888      3.549298       2.731750     -0.356199      -0.533577  
5889      0.607662       0.172679      0.236675      -0.102960  
5890     -0.669750      -0.938603     -0.356199      -0.533577  
5891     -0.669750      -0.938603     -0.356199      -0.533577  
5892      0.752371       0.298568      0.983607       0.439552  
5893     -0.669750      -0.938603     -0.356199      -0.533577  
5894      0.479575       0.743129      0.235013       0.461393  
5895      0.613866       0.781591      0.662335       1.210891  
5896     -0.669750      -0.938603     -0.356199      -0.533577  
5897      0.929480       0.452644      0.236675      -0.102960  
5898     -0.669750      -0.938603     -0.356199      -0.533577  
5899     -0.669750      -0.938603     -0.356199      -0.533577  
5900     -0.669750      -0.938603     -0.356199      -0.533577  
5901     -0.669750      -0.938603     -0.356199      -0.533577  
5902      0.929480       0.452644     -0.356199      -0.533577  
5903     -0.119599      -0.460000     -0.356199      -0.533577  
5904      0.202219      -0.180035      0.657325       0.202567  

[5905 rows x 17 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  TransactionAmt  isFraud  nd_TransactionAmt_fraud  \
0            W         117.000        0                -0.059625   
1            W         117.000        0                -0.059625   
2            C          22.235        0                -0.513741   
3            W          59.000        0                -0.763410   
4            W          53.970        0                -0.854520   
5            W          30.950        0                -1.419155   
6            W         311.950        0                 0.955314   
7            H         100.000        0                 0.020170   
8            W          26.000        0                -1.594321   
9            W         117.000        0                -0.059625   
10           W          35.950        0                -1.267861   
11           C          30.782        0                -0.118172   
12           W          44.000        0                -1.062766   
13           W          57.950        0                -0.781782   
14           W          50.000        0                -0.932524   
15           W         117.000        0                -0.059625   
16           W        1532.470        0                 2.609049   
17           H          30.000        0                -1.091406   
18           W          24.500        0                -1.653799   
19           W          39.000        0                -1.185329   
20           W          77.000        0                -0.490399   
21           W          57.950        0                -0.781782   
22           W          44.500        0                -1.051268   
23           C          53.869        0                 0.571394   
24           C          41.931        0                 0.261553   
25           W         255.000        0                 0.746297   
26           W         374.950        0                 1.146169   
27           W         159.950        0                 0.263381   
28           W         117.000        0                -0.059625   
29           W          57.950        0                -0.781782   
...        ...             ...      ...                      ...   
5875         W          97.950        0                -0.242839   
5876         C          16.918        1                -0.841892   
5877         H          50.000        0                -0.622886   
5878         W          25.950        0                -1.596250   
5879         H          25.000        0                -1.256939   
5880         W        1264.950        0                 2.409559   
5881         C          51.654        0                 0.519357   
5882         W         445.000        0                 1.323965   
5883         C          26.434        0                -0.303956   
5884         W         117.000        0                -0.059625   
5885         H         150.000        0                 0.398646   
5886         H          25.000        0                -1.256939   
5887         H          50.000        0                -0.622886   
5888         W          43.000        0                -1.086151   
5889         W          29.000        0                -1.484685   
5890         W         107.950        0                -0.142658   
5891         W          44.500        0                -1.051268   
5892         W          50.000        0                -0.932524   
5893         W          80.000        0                -0.451128   
5894         C          29.486        0                -0.170747   
5895         S          50.000        0                 0.342608   
5896         W         380.000        0                 1.160054   
5897         W          51.000        0                -0.912318   
5898         W         449.660        0                 1.334782   
5899         W         893.060        0                 2.047641   
5900         W          21.950        0                -1.763435   
5901         W         524.950        0                 1.495544   
5902         W         107.950        0                -0.142658   
5903         W          77.000        0                -0.490399   
5904         W          59.000        0                -0.763410   

      nd_TransactionAmt_normal  nd_C1_fraud  nd_C1_normal  nd_C2_fraud  \
0                     0.306795    -0.672238     -0.608858    -0.670399   
1                     0.306795     0.281382      0.104134    -0.670399   
2                    -0.465926    -1.148647     -0.286952    -0.957026   
3                    -0.457572    -0.114406     -0.191785     0.317777   
4                    -0.556525     5.230499      3.804434     5.455968   
5                    -1.169763     5.172766      3.761268     5.130554   
6                     1.409100     0.281382      0.104134    -0.092353   
7                     0.940693    -0.629921     -0.309434    -0.640895   
8                    -1.360007    -0.672238     -0.608858    -0.670399   
9                     0.306795    -0.114406     -0.191785    -0.670399   
10                   -1.005446     0.839213      0.521207     1.115586   
11                   -0.065970    -1.148647     -0.286952    -0.781781   
12                   -0.782696    -0.672238     -0.608858    -0.092353   
13                   -0.477525    -0.672238     -0.608858    -0.092353   
14                   -0.641243    -0.672238     -0.608858    -0.670399   
15                    0.306795    -0.114406     -0.191785    -0.670399   
16                    3.205189    -0.672238     -0.608858    -0.670399   
17                   -0.995048    -0.629921     -0.309434    -0.640895   
18                   -1.424605    -0.672238     -0.608858    -0.670399   
19                   -0.915809    -0.672238     -0.608858    -0.670399   
20                   -0.161060    -0.672238     -0.608858    -0.670399   
21                   -0.477525     0.588379      0.333665     0.635898   
22                   -0.770208    -0.672238     -0.608858    -0.670399   
23                    0.631242    -0.889462      0.207788    -0.781781   
24                    0.317966    -0.889462      0.207788    -0.781781   
25                    1.182090     0.281382      0.104134     0.317777   
26                    1.616384    -0.672238     -0.608858    -0.092353   
27                    0.657605     0.281382      0.104134    -0.670399   
28                    0.306795    -0.672238     -0.608858    -0.670399   
29                   -0.477525    -0.672238     -0.608858    -0.092353   
...                        ...          ...           ...          ...   
5875                  0.107810     2.802614      1.989180     2.872175   
5876                 -0.797716     1.867560      5.470463     1.790811   
5877                 -0.179148    -0.629921     -0.309434    -0.640895   
5878                 -1.362102    -0.672238     -0.608858    -0.670399   
5879                 -1.283312    -0.629921     -0.309434    -0.640895   
5880                  2.988527    -0.672238     -0.608858    -0.670399   
5881                  0.578629    -1.148647     -0.286952    -1.204019   
5882                  1.809485    -0.114406     -0.191785     0.895823   
5883                 -0.253814    -1.148647     -0.286952    -1.204019   
5884                  0.306795    -0.672238     -0.608858    -0.670399   
5885                  1.599786    -0.629921     -0.309434    -0.640895   
5886                 -1.283312    -0.629921     -0.309434    -0.640895   
5887                 -0.179148    -0.629921     -0.309434    -0.640895   
5888                 -0.808094    -0.114406     -0.191785    -0.670399   
5889                 -1.240934    -0.114406     -0.191785    -0.670399   
5890                  0.216614    -0.672238     -0.608858    -0.092353   
5891                 -0.770208    -0.672238     -0.608858    -0.670399   
5892                 -0.641243     0.588379      0.333665     0.317777   
5893                 -0.118408    -0.672238     -0.608858    -0.670399   
5894                 -0.119128    -0.889462      0.207788    -0.165554   
5895                  0.223026    -0.176438      1.048071     0.783132   
5896                  1.631464    -0.114406     -0.191785    -0.670399   
5897                 -0.619298    -0.114406     -0.191785    -0.092353   
5898                  1.821232    -0.672238     -0.608858    -0.670399   
5899                  2.595454    -0.672238     -0.608858    -0.670399   
5900                 -1.543678    -0.672238     -0.608858    -0.670399   
5901                  1.995833    -0.672238     -0.608858    -0.670399   
5902                  0.216614    -0.672238     -0.608858    -0.670399   
5903                 -0.161060    -0.672238     -0.608858    -0.670399   
5904                 -0.457572     0.281382      0.104134    -0.670399   

      nd_C2_normal  nd_C6_fraud  nd_C6_normal  nd_C11_fraud  nd_C11_normal  \
0        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1        -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
2        -0.098785    -0.893332     -0.205270     -1.032901      -0.286967   
3         0.145844     0.130028      0.017531      0.188385      -0.011909   
4         3.946140     5.677634      3.934259      5.883932       3.950753   
5         3.705458     5.259970      3.639379      5.899889       3.961856   
6        -0.157496     0.130028      0.017531      0.654332       0.312272   
7        -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
8        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
9        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
10        0.735917     1.165502      0.748598      1.015749       0.563727   
11        0.195667    -0.493837      0.335431     -0.724316       0.225499   
12       -0.157496     0.130028      0.017531      0.188385      -0.011909   
13       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
14       -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
15       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
16       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
17       -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
18       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
19       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
20       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
21        0.381132    -0.475686     -0.410116     -0.468330      -0.468818   
22       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
23        0.195667    -0.893332     -0.205270     -0.724316       0.225499   
24        0.195667    -0.893332     -0.205270     -1.032901      -0.286967   
25        0.145844     0.893136      0.556302     -0.468330      -0.468818   
26       -0.157496     0.130028      0.017531     -0.468330      -0.468818   
27       -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
28       -0.585029     0.893136      0.556302     -0.468330      -0.468818   
29       -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
...            ...          ...           ...           ...            ...   
5875      2.035121     2.887459      1.964336      3.340098       2.180887   
5876      4.518236     2.007758      3.721236      1.683746       4.224551   
5877     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5878     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5879     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5880     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5881     -0.513793    -0.893332     -0.205270     -1.032901      -0.286967   
5882      0.573376     0.893136      0.556302      0.654332       0.312272   
5883     -0.513793    -0.493837      0.335431     -1.032901      -0.286967   
5884     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5885     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5886     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5887     -0.217957    -0.481202     -0.202963     -0.590531      -0.221319   
5888     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5889     -0.585029     0.559788      0.320951     -0.468330      -0.468818   
5890     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
5891     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
5892      0.145844     1.165502      0.748598      0.654332       0.312272   
5893     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
5894      1.231076    -0.893332     -0.205270     -0.724316       0.225499   
5895      1.775788    -0.301511     -0.134553      0.452816       1.258122   
5896     -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
5897     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
5898     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5899     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5900     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5901     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5902     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5903     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5904     -0.585029     0.130028      0.017531     -0.468330      -0.468818   

      nd_C13_fraud  nd_C13_normal  nd_C14_fraud  nd_C14_normal  
0        -1.219901      -1.417207     -1.369724      -1.269720  
1        -0.119599      -0.460000     -0.356199      -0.533577  
2        -0.405600      -0.278449     -0.255669      -0.109273  
3         1.624340       1.057136     -0.356199      -0.533577  
4         3.816634       2.964319      5.568349       3.769544  
5         3.581776       2.760004      5.363988       3.621113  
6         0.324569      -0.073598      0.657325       0.202567  
7        -0.629002      -1.729233     -0.670258      -1.784973  
8        -0.669750      -0.938603     -0.356199      -0.533577  
9        -0.347932      -0.658639      0.236675      -0.102960  
10        1.334922       0.805358      1.250199       0.633184  
11       -0.405600      -0.278449     -0.255669      -0.109273  
12       -0.669750      -0.938603     -0.356199      -0.533577  
13        1.396006       0.858498     -0.356199      -0.533577  
14        0.202219      -0.180035     -0.356199      -0.533577  
15       -0.347932      -0.658639      0.236675      -0.102960  
16       -0.669750      -0.938603     -0.356199      -0.533577  
17       -0.629002      -1.729233     -0.670258      -1.784973  
18       -0.669750      -0.938603     -0.356199      -0.533577  
19        0.202219      -0.180035     -0.356199      -0.533577  
20        0.874720       0.405006     -0.356199      -0.533577  
21        1.396006       0.858498      0.983607       0.439552  
22       -0.669750      -0.938603     -0.356199      -0.533577  
23       -0.405600      -0.278449     -0.255669      -0.109273  
24       -0.405600      -0.278449     -0.255669      -0.109273  
25        0.524037       0.099930      0.657325       0.202567  
26       -0.669750      -0.938603     -0.356199      -0.533577  
27        1.396006       0.858498      0.657325       0.202567  
28        0.607662       0.172679     -0.356199      -0.533577  
29       -0.347932      -0.658639     -0.356199      -0.533577  
...            ...            ...           ...            ...  
5875      2.196238       1.554658      3.010657       1.911840  
5876      1.474229       1.891059      1.807367       2.290049  
5877      0.572203       0.413196      0.708017       0.479974  
5878     -0.669750      -0.938603     -0.356199      -0.533577  
5879      0.572203       0.413196      0.708017       0.479974  
5880     -0.669750      -0.938603     -0.356199      -0.533577  
5881     -0.405600      -0.278449     -0.255669      -0.109273  
5882      0.683310       0.238488      0.236675      -0.102960  
5883     -0.013904       0.173607     -0.255669      -0.109273  
5884     -0.347932      -0.658639     -0.356199      -0.533577  
5885      0.572203       0.413196      0.708017       0.479974  
5886      0.572203       0.413196      0.708017       0.479974  
5887     -0.629002      -1.729233     -0.670258      -1.784973  
5888      3.549298       2.731750     -0.356199      -0.533577  
5889      0.607662       0.172679      0.236675      -0.102960  
5890     -0.669750      -0.938603     -0.356199      -0.533577  
5891     -0.669750      -0.938603     -0.356199      -0.533577  
5892      0.752371       0.298568      0.983607       0.439552  
5893     -0.669750      -0.938603     -0.356199      -0.533577  
5894      0.479575       0.743129      0.235013       0.461393  
5895      0.613866       0.781591      0.662335       1.210891  
5896     -0.669750      -0.938603     -0.356199      -0.533577  
5897      0.929480       0.452644      0.236675      -0.102960  
5898     -0.669750      -0.938603     -0.356199      -0.533577  
5899     -0.669750      -0.938603     -0.356199      -0.533577  
5900     -0.669750      -0.938603     -0.356199      -0.533577  
5901     -0.669750      -0.938603     -0.356199      -0.533577  
5902      0.929480       0.452644     -0.356199      -0.533577  
5903     -0.119599      -0.460000     -0.356199      -0.533577  
5904      0.202219      -0.180035      0.657325       0.202567  

[5905 rows x 17 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  TransactionAmt  isFraud  nd_TransactionAmt_fraud  \
0            W          117.00        0                -0.059625   
3899         W          130.00        0                 0.049129   
3900         W           59.00        0                -0.763410   
3901         W          209.95        0                 0.544886   
3902         W           59.00        0                -0.763410   
3903         W           43.95        0                -1.063923   
3904         W           24.00        0                -1.674405   
3906         W           47.95        0                -0.975215   
3907         W           39.00        0                -1.185329   
3908         W          117.00        0                -0.059625   
3909         W           54.53        0                -0.843973   
3910         W           35.95        0                -1.267861   
3911         W          107.95        0                -0.142658   
3912         W           67.95        0                -0.618731   
3914         W           47.95        0                -0.975215   
3898         W           47.95        0                -0.975215   
3915         W          117.00        0                -0.059625   
3918         W          395.89        0                 1.202572   
3919         W          107.95        0                -0.142658   
3920         W          310.00        0                 0.948810   
3921         W           39.00        0                -1.185329   
3922         W           39.00        0                -1.185329   
3923         W           58.95        0                -0.764278   
3925         W           49.00        0                -0.953130   
3926         W           47.95        0                -0.975215   
3927         W           54.95        0                -0.836132   
3928         W           42.95        0                -1.087334   
3929         W           49.00        0                -0.953130   
3930         W           82.00        0                -0.425746   
3932         W           15.00        0                -2.138802   
...        ...             ...      ...                      ...   
4994         W          240.00        1                 0.683466   
2248         W          130.95        1                 0.056648   
127          W           24.50        1                -1.653799   
3758         W          488.00        1                 1.419744   
682          W           39.00        1                -1.185329   
2074         W          490.00        1                 1.423991   
116          W           59.00        1                -0.763410   
1573         W          117.00        1                -0.059625   
695          W          186.00        1                 0.419483   
5709         W          141.00        1                 0.133031   
2818         W           59.00        1                -0.763410   
1318         W          186.00        1                 0.419483   
3503         W          226.00        1                 0.621190   
4886         W           59.00        1                -0.763410   
250          W          335.00        1                 1.029265   
3481         W          113.95        1                -0.086875   
4158         W          224.00        1                 0.611982   
3843         W          226.00        1                 0.621190   
4163         W          664.00        1                 1.739644   
2687         W          232.95        1                 0.652572   
5662         W           39.00        1                -1.185329   
1290         W           29.00        1                -1.484685   
2692         W           55.95        1                -0.817698   
4911         W           87.00        1                -0.364876   
5671         W          117.00        1                -0.059625   
5675         W           29.00        1                -1.484685   
952          W           29.00        1                -1.484685   
1298         W          161.00        1                 0.270147   
938          W          664.00        1                 1.739644   
5488         W          201.00        1                 0.499773   

      nd_TransactionAmt_normal  nd_C1_fraud  nd_C1_normal  nd_C2_fraud  \
0                     0.306795    -0.672238     -0.608858    -0.670399   
3899                  0.424911    -0.672238     -0.608858    -0.670399   
3900                 -0.457572    -0.672238     -0.608858    -0.670399   
3901                  0.963342    -0.672238     -0.608858    -0.670399   
3902                 -0.457572    -0.672238     -0.608858    -0.092353   
3903                 -0.783953    -0.114406     -0.191785    -0.092353   
3904                 -1.446985    -0.672238     -0.608858    -0.670399   
3906                 -0.687609     0.839213      0.521207     0.895823   
3907                 -0.915809    -0.672238     -0.608858    -0.092353   
3908                  0.306795    -0.672238     -0.608858     0.317777   
3909                 -0.545070     0.281382      0.104134    -0.092353   
3910                 -1.005446     0.588379      0.333665     0.635898   
3911                  0.216614    -0.672238     -0.608858    -0.092353   
3912                 -0.300439    -0.114406     -0.191785    -0.670399   
3914                 -0.687609     0.281382      0.104134    -0.092353   
3898                 -0.687609     5.503148      4.008284     5.475234   
3915                  0.306795     0.281382      0.104134    -0.092353   
3918                  1.677642    -0.672238     -0.608858    -0.670399   
3919                  0.216614    -0.672238     -0.608858    -0.670399   
3920                  1.402036    -0.672238     -0.608858    -0.670399   
3921                 -0.915809    -0.672238     -0.608858    -0.670399   
3922                 -0.915809    -0.672238     -0.608858    -0.670399   
3923                 -0.458514    -0.672238     -0.608858    -0.670399   
3925                 -0.663623    -0.114406     -0.191785     0.317777   
3926                 -0.687609     0.839213      0.521207     0.317777   
3927                 -0.536554    -0.672238     -0.608858    -0.092353   
3928                 -0.809379    -0.672238     -0.608858    -0.670399   
3929                 -0.663623    -0.672238     -0.608858    -0.670399   
3930                 -0.090842     1.051291      0.679771     0.317777   
3932                 -1.951357    -0.672238     -0.608858    -0.670399   
...                        ...          ...           ...          ...   
4994                  1.113851    -0.672238     -0.608858    -0.670399   
2248                  0.433077     4.074193      2.939900     3.974463   
127                  -1.424605    -0.672238     -0.608858    -0.670399   
3758                  1.913508     0.839213      0.521207    -0.092353   
682                  -0.915809    -0.114406     -0.191785    -0.670399   
2074                  1.918121    -0.672238     -0.608858    -0.670399   
116                  -0.457572    -0.114406     -0.191785    -0.092353   
1573                  0.306795    -0.672238     -0.608858    -0.670399   
695                   0.827145    -0.672238     -0.608858    -0.670399   
5709                  0.516035    -0.114406     -0.191785    -0.092353   
2818                 -0.457572    -0.114406     -0.191785    -0.670399   
1318                  0.827145     0.839213      0.521207     0.317777   
3503                  1.046215    -0.672238     -0.608858    -0.092353   
4886                 -0.457572    -0.114406     -0.191785    -0.670399   
250                   1.489417    -0.672238     -0.608858    -0.670399   
3481                  0.277200    -0.672238     -0.608858    -0.670399   
4158                  1.036214    -0.672238     -0.608858    -0.670399   
3843                  1.046215    -0.672238     -0.608858    -0.670399   
4163                  2.260945    -0.672238     -0.608858    -0.092353   
2687                  1.080298    -0.114406     -0.191785    -0.092353   
5662                 -0.915809    -0.672238     -0.608858     0.317777   
1290                 -1.240934    -0.114406     -0.191785    -0.670399   
2692                 -0.516533    -0.114406     -0.191785    -0.670399   
4911                 -0.024732    -0.672238     -0.608858    -0.092353   
5671                  0.306795     1.051291      0.679771     0.317777   
5675                 -1.240934     2.004911      1.392762     1.883999   
952                  -1.240934     0.839213      0.521207     0.635898   
1298                  0.664954    -0.672238     -0.608858    -0.670399   
938                   2.260945    -0.672238     -0.608858    -0.670399   
5488                  0.914346    -0.672238     -0.608858    -0.670399   

      nd_C2_normal  nd_C6_fraud  nd_C6_normal  nd_C11_fraud  nd_C11_normal  \
0        -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3899     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3900     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3901     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3902     -0.157496    -1.511160     -1.141183     -0.468330      -0.468818   
3903     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3904     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3906      0.573376     0.559788      0.320951      1.015749       0.563727   
3907     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
3908      0.145844    -0.475686     -0.410116     -0.468330      -0.468818   
3909     -0.157496     0.130028      0.017531      0.188385      -0.011909   
3910      0.381132     0.559788      0.320951      0.654332       0.312272   
3911     -0.157496    -1.511160     -1.141183      0.188385      -0.011909   
3912     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3914     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3898      3.960389     5.677634      3.934259      6.280249       4.226490   
3915     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3918     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3919     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3920     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3921     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3922     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3923     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3925      0.145844    -0.475686     -0.410116      0.188385      -0.011909   
3926      0.145844     0.130028      0.017531      0.188385      -0.011909   
3927     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
3928     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3929     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3930      0.145844    -0.475686     -0.410116     -0.468330      -0.468818   
3932     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
...            ...          ...           ...           ...            ...   
4994     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
2248      2.850392     3.666211      2.514151      4.610103       3.064490   
127      -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3758     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
682      -0.585029    -1.511160     -1.141183      0.188385      -0.011909   
2074     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
116      -0.157496     0.130028      0.017531     -0.468330      -0.468818   
1573     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
695      -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5709     -0.157496     0.130028      0.017531      0.188385      -0.011909   
2818     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1318      0.145844     0.130028      0.017531      0.654332       0.312272   
3503     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
4886     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
250      -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3481     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
4158     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3843     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
4163     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
2687     -0.157496    -0.475686     -0.410116      0.188385      -0.011909   
5662      0.145844     0.893136      0.556302      0.188385      -0.011909   
1290     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
2692     -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
4911     -0.157496    -0.475686     -0.410116      0.188385      -0.011909   
5671      0.145844     1.165502      0.748598      0.654332       0.312272   
5675      1.304249     1.595262      1.052018      1.560720       0.942889   
952       0.381132     0.130028      0.017531     -0.468330      -0.468818   
1298     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
938      -0.585029     0.130028      0.017531     -0.468330      -0.468818   
5488     -0.585029    -1.511160     -1.141183     -1.590993      -1.249907   

      nd_C13_fraud  nd_C13_normal  nd_C14_fraud  nd_C14_normal  
0        -1.219901      -1.417207     -1.369724      -1.269720  
3899     -0.669750      -0.938603     -0.356199      -0.533577  
3900     -0.669750      -0.938603     -0.356199      -0.533577  
3901      0.057510      -0.305924     -0.356199      -0.533577  
3902      1.028822       0.539066     -0.356199      -0.533577  
3903     -0.119599      -0.460000     -0.356199      -0.533577  
3904     -0.669750      -0.938603     -0.356199      -0.533577  
3906      0.324569      -0.073598      1.250199       0.633184  
3907     -0.119599      -0.460000     -0.356199      -0.533577  
3908      1.268742       0.747785     -0.356199      -0.533577  
3909      0.202219      -0.180035      0.657325       0.202567  
3910      0.874720       0.405006      0.657325       0.202567  
3911      0.324569      -0.073598     -0.356199      -0.533577  
3912     -0.119599      -0.460000      0.236675      -0.102960  
3914      0.324569      -0.073598      0.657325       0.202567  
3898      3.701447       2.864111      5.907290       4.015725  
3915      0.430553       0.018603      0.657325       0.202567  
3918     -0.347932      -0.658639     -0.356199      -0.533577  
3919      0.324569      -0.073598     -0.356199      -0.533577  
3920     -0.669750      -0.938603     -0.356199      -0.533577  
3921     -0.669750      -0.938603     -0.356199      -0.533577  
3922     -0.669750      -0.938603     -0.356199      -0.533577  
3923     -0.669750      -0.938603     -0.356199      -0.533577  
3925     -0.119599      -0.460000      0.236675      -0.102960  
3926      1.479631       0.931247      1.250199       0.633184  
3927      0.057510      -0.305924     -0.356199      -0.533577  
3928     -0.347932      -0.658639     -0.356199      -0.533577  
3929     -0.669750      -0.938603     -0.356199      -0.533577  
3930      2.803291       2.082763      1.250199       0.633184  
3932      0.929480       0.452644     -0.356199      -0.533577  
...            ...            ...           ...            ...  
4994     -0.669750      -0.938603     -0.356199      -0.533577  
2248      2.258116       1.608488      3.697899       2.410998  
127      -0.669750      -0.938603     -0.356199      -0.533577  
3758      1.885074       1.283961      0.657325       0.202567  
682      -0.347932      -0.658639     -0.356199      -0.533577  
2074     -1.219901      -1.417207     -1.369724      -1.269720  
116      -0.119599      -0.460000      0.236675      -0.102960  
1573     -0.669750      -0.938603     -0.356199      -0.533577  
695      -0.347932      -0.658639     -0.356199      -0.533577  
5709      0.324569      -0.073598      0.236675      -0.102960  
2818     -0.119599      -0.460000      0.236675      -0.102960  
1318      1.196538       0.684971      0.983607       0.439552  
3503      0.324569      -0.073598     -0.356199      -0.533577  
4886     -0.669750      -0.938603     -0.356199      -0.533577  
250      -0.119599      -0.460000     -0.356199      -0.533577  
3481     -0.669750      -0.938603     -0.356199      -0.533577  
4158     -1.219901      -1.417207     -1.369724      -1.269720  
3843     -0.669750      -0.938603     -0.356199      -0.533577  
4163      1.396006       0.858498     -0.356199      -0.533577  
2687     -0.669750      -0.938603     -0.356199      -0.533577  
5662      0.202219      -0.180035     -0.356199      -0.533577  
1290     -0.347932      -0.658639     -0.356199      -0.533577  
2692      1.117102       0.615865      0.236675      -0.102960  
4911     -0.669750      -0.938603     -0.356199      -0.533577  
5671      0.324569      -0.073598      0.236675      -0.102960  
5675      2.258116       1.608488      2.136495       1.276919  
952      -0.347932      -0.658639     -0.356199      -0.533577  
1298     -0.669750      -0.938603     -0.356199      -0.533577  
938      -0.669750      -0.938603     -0.356199      -0.533577  
5488     -0.669750      -0.938603     -0.356199      -0.533577  

[4426 rows x 17 columns]
original train/test shape: (5905, 440) (5067, 439)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 482) (5067, 481)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     ProductCD  TransactionAmt  isFraud  nd_TransactionAmt_fraud  \
3            W            59.0        0                 -0.76341   
3614         W            59.0        0                 -0.76341   
3611         W            59.0        0                 -0.76341   
3594         W            59.0        0                 -0.76341   
3591         W            59.0        0                 -0.76341   
3566         W            59.0        0                 -0.76341   
3536         W            59.0        0                 -0.76341   
3535         W            59.0        0                 -0.76341   
3642         W            59.0        0                 -0.76341   
3532         W            59.0        0                 -0.76341   
3523         W            59.0        0                 -0.76341   
3492         W            59.0        0                 -0.76341   
3482         W            59.0        0                 -0.76341   
3471         W            59.0        0                 -0.76341   
3463         W            59.0        0                 -0.76341   
3426         W            59.0        0                 -0.76341   
3407         W            59.0        0                 -0.76341   
3527         W            59.0        0                 -0.76341   
3400         W            59.0        0                 -0.76341   
3688         W            59.0        0                 -0.76341   
3720         W            59.0        0                 -0.76341   
4122         W            59.0        0                 -0.76341   
4094         W            59.0        0                 -0.76341   
4052         W            59.0        0                 -0.76341   
4051         W            59.0        0                 -0.76341   
3999         W            59.0        0                 -0.76341   
3985         W            59.0        0                 -0.76341   
3968         W            59.0        0                 -0.76341   
3718         W            59.0        0                 -0.76341   
3902         W            59.0        0                 -0.76341   
...        ...             ...      ...                      ...   
1464         W            59.0        0                 -0.76341   
1455         W            59.0        0                 -0.76341   
1565         W            59.0        0                 -0.76341   
1681         W            59.0        0                 -0.76341   
5904         W            59.0        0                 -0.76341   
1713         W            59.0        0                 -0.76341   
1890         W            59.0        0                 -0.76341   
1885         W            59.0        0                 -0.76341   
1880         W            59.0        0                 -0.76341   
1702         W            59.0        0                 -0.76341   
1875         W            59.0        0                 -0.76341   
1896         W            59.0        0                 -0.76341   
1870         W            59.0        0                 -0.76341   
1907         W            59.0        0                 -0.76341   
1852         W            59.0        0                 -0.76341   
1849         W            59.0        0                 -0.76341   
1821         W            59.0        0                 -0.76341   
1727         W            59.0        0                 -0.76341   
1720         W            59.0        0                 -0.76341   
1867         W            59.0        0                 -0.76341   
1899         W            59.0        0                 -0.76341   
116          W            59.0        1                 -0.76341   
4001         W            59.0        1                 -0.76341   
1409         W            59.0        1                 -0.76341   
412          W            59.0        1                 -0.76341   
3869         W            59.0        1                 -0.76341   
3189         W            59.0        1                 -0.76341   
1855         W            59.0        1                 -0.76341   
2818         W            59.0        1                 -0.76341   
4886         W            59.0        1                 -0.76341   

      nd_TransactionAmt_normal  nd_C1_fraud  nd_C1_normal  nd_C2_fraud  \
3                    -0.457572    -0.114406     -0.191785     0.317777   
3614                 -0.457572    -0.114406     -0.191785    -0.092353   
3611                 -0.457572    -0.672238     -0.608858    -0.670399   
3594                 -0.457572     0.281382      0.104134    -0.092353   
3591                 -0.457572    -0.672238     -0.608858    -0.670399   
3566                 -0.457572    -0.672238     -0.608858    -0.670399   
3536                 -0.457572    -0.672238     -0.608858    -0.670399   
3535                 -0.457572     0.281382      0.104134    -0.092353   
3642                 -0.457572    -0.672238     -0.608858    -0.092353   
3532                 -0.457572     1.902954      1.316532     1.473869   
3523                 -0.457572    -0.672238     -0.608858    -0.092353   
3492                 -0.457572     2.272027      1.592476     2.380558   
3482                 -0.457572    -0.114406     -0.191785    -0.670399   
3471                 -0.457572    -0.672238     -0.608858    -0.670399   
3463                 -0.457572    -0.672238     -0.608858    -0.670399   
3426                 -0.457572     0.588379      0.333665     1.624074   
3407                 -0.457572    -0.114406     -0.191785    -0.092353   
3527                 -0.457572    -0.672238     -0.608858    -0.670399   
3400                 -0.457572    -0.672238     -0.608858    -0.670399   
3688                 -0.457572    -0.672238     -0.608858    -0.670399   
3720                 -0.457572    -0.672238     -0.608858    -0.092353   
4122                 -0.457572     5.526142      4.025476     5.594488   
4094                 -0.457572    -0.114406     -0.191785    -0.670399   
4052                 -0.457572    -0.672238     -0.608858    -0.670399   
4051                 -0.457572    -0.672238     -0.608858    -0.092353   
3999                 -0.457572    -0.672238     -0.608858    -0.670399   
3985                 -0.457572    -0.672238     -0.608858    -0.670399   
3968                 -0.457572    -0.672238     -0.608858    -0.670399   
3718                 -0.457572    -0.672238     -0.608858    -0.092353   
3902                 -0.457572    -0.672238     -0.608858    -0.092353   
...                        ...          ...           ...          ...   
1464                 -0.457572    -0.114406     -0.191785     0.317777   
1455                 -0.457572    -0.672238     -0.608858    -0.670399   
1565                 -0.457572    -0.672238     -0.608858    -0.670399   
1681                 -0.457572    -0.672238     -0.608858    -0.670399   
5904                 -0.457572     0.281382      0.104134    -0.670399   
1713                 -0.457572    -0.114406     -0.191785    -0.092353   
1890                 -0.457572    -0.114406     -0.191785    -0.670399   
1885                 -0.457572     1.051291      0.679771     0.317777   
1880                 -0.457572    -0.672238     -0.608858    -0.670399   
1702                 -0.457572    -0.672238     -0.608858    -0.670399   
1875                 -0.457572    -0.672238     -0.608858    -0.670399   
1896                 -0.457572    -0.672238     -0.608858    -0.670399   
1870                 -0.457572    -0.672238     -0.608858    -0.670399   
1907                 -0.457572    -0.672238     -0.608858    -0.670399   
1852                 -0.457572    -0.672238     -0.608858    -0.670399   
1849                 -0.457572    -0.672238     -0.608858    -0.670399   
1821                 -0.457572    -0.114406     -0.191785     0.317777   
1727                 -0.457572    -0.672238     -0.608858     0.317777   
1720                 -0.457572     0.839213      0.521207     0.635898   
1867                 -0.457572    -0.114406     -0.191785    -0.670399   
1899                 -0.457572    -0.672238     -0.608858    -0.670399   
116                  -0.457572    -0.114406     -0.191785    -0.092353   
4001                 -0.457572    -0.672238     -0.608858    -0.092353   
1409                 -0.457572    -0.672238     -0.608858    -0.670399   
412                  -0.457572    -0.672238     -0.608858    -0.092353   
3869                 -0.457572    -0.114406     -0.191785     0.317777   
3189                 -0.457572     2.099830      1.463730     2.462045   
1855                 -0.457572     1.051291      0.679771     1.883999   
2818                 -0.457572    -0.114406     -0.191785    -0.670399   
4886                 -0.457572    -0.114406     -0.191785    -0.670399   

      nd_C2_normal  nd_C6_fraud  nd_C6_normal  nd_C11_fraud  nd_C11_normal  \
3         0.145844     0.130028      0.017531      0.188385      -0.011909   
3614     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
3611     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3594     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3591     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3566     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3536     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3535     -0.157496     0.130028      0.017531      0.188385      -0.011909   
3642     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
3532      1.000909     2.200976      1.479664      1.776995       1.093362   
3523     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3492      1.671512     1.595262      1.052018      1.967763       1.226088   
3482     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3471     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3463     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3426      1.112004     0.130028      0.017531     -0.468330      -0.468818   
3407     -0.157496    -0.475686     -0.410116      0.188385      -0.011909   
3527     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3400     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3688     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3720     -0.157496    -1.511160     -1.141183     -0.468330      -0.468818   
4122      4.048592     5.827725      4.040226      6.149561       4.135564   
4094     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
4052     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
4051     -0.157496    -1.511160     -1.141183     -0.468330      -0.468818   
3999     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3985     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
3968     -0.585029    -1.511160     -1.141183     -0.468330      -0.468818   
3718     -0.157496    -0.475686     -0.410116     -0.468330      -0.468818   
3902     -0.157496    -1.511160     -1.141183     -0.468330      -0.468818   
...            ...          ...           ...           ...            ...   
1464      0.145844     0.130028      0.017531      0.188385      -0.011909   
1455     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1565     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1681     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
5904     -0.585029     0.130028      0.017531     -0.468330      -0.468818   
1713     -0.157496     0.130028      0.017531      0.188385      -0.011909   
1890     -0.585029    -0.475686     -0.410116      0.188385      -0.011909   
1885      0.145844     0.130028      0.017531     -0.468330      -0.468818   
1880     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1702     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1875     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1896     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1870     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1907     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1852     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1849     -0.585029     0.559788      0.320951     -0.468330      -0.468818   
1821      0.145844    -1.511160     -1.141183     -0.468330      -0.468818   
1727      0.145844     0.130028      0.017531     -0.468330      -0.468818   
1720      0.381132     0.130028      0.017531     -0.468330      -0.468818   
1867     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
1899     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
116      -0.157496     0.130028      0.017531     -0.468330      -0.468818   
4001     -0.157496     0.130028      0.017531     -0.468330      -0.468818   
1409     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
412      -0.157496     0.130028      0.017531     -0.468330      -0.468818   
3869      0.145844     0.130028      0.017531      0.188385      -0.011909   
3189      1.731781     1.928611      1.287369      1.560720       0.942889   
1855      1.304249     2.070992      1.387893      0.188385      -0.011909   
2818     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   
4886     -0.585029    -0.475686     -0.410116     -0.468330      -0.468818   

      nd_C13_fraud  nd_C13_normal  nd_C14_fraud  nd_C14_normal  
3         1.624340       1.057136     -0.356199      -0.533577  
3614      0.057510      -0.305924      0.236675      -0.102960  
3611     -1.219901      -1.417207     -1.369724      -1.269720  
3594      1.028822       0.539066      0.236675      -0.102960  
3591      0.524037       0.099930     -0.356199      -0.533577  
3566     -0.669750      -0.938603     -0.356199      -0.533577  
3536     -0.669750      -0.938603     -0.356199      -0.533577  
3535      0.752371       0.298568      0.236675      -0.102960  
3642     -0.119599      -0.460000     -0.356199      -0.533577  
3532      2.342732       1.682100      2.263724       1.369327  
3523     -0.347932      -0.658639     -0.356199      -0.533577  
3492      2.258116       1.608488      2.489124       1.533040  
3482     -0.347932      -0.658639      0.236675      -0.102960  
3471     -0.669750      -0.938603     -0.356199      -0.533577  
3463     -0.669750      -0.938603     -0.356199      -0.533577  
3426      1.074189       0.578533      0.983607       0.439552  
3407      0.057510      -0.305924      0.236675      -0.102960  
3527     -0.347932      -0.658639     -0.356199      -0.533577  
3400     -0.669750      -0.938603     -0.356199      -0.533577  
3688     -0.669750      -0.938603     -0.356199      -0.533577  
3720      0.430553       0.018603     -0.356199      -0.533577  
4122      4.020577       3.141738      6.023554       4.100169  
4094      1.028822       0.539066     -0.356199      -0.533577  
4052     -0.669750      -0.938603     -0.356199      -0.533577  
4051     -0.347932      -0.658639     -0.356199      -0.533577  
3999     -0.119599      -0.460000     -0.356199      -0.533577  
3985     -1.219901      -1.417207     -1.369724      -1.269720  
3968     -0.119599      -0.460000     -0.356199      -0.533577  
3718      0.202219      -0.180035     -0.356199      -0.533577  
3902      1.028822       0.539066     -0.356199      -0.533577  
...            ...            ...           ...            ...  
1464      0.874720       0.405006     -0.356199      -0.533577  
1455     -0.669750      -0.938603     -0.356199      -0.533577  
1565     -0.669750      -0.938603     -0.356199      -0.533577  
1681      2.435225       1.762564     -0.356199      -0.533577  
5904      0.202219      -0.180035      0.657325       0.202567  
1713      0.752371       0.298568     -0.356199      -0.533577  
1890     -0.347932      -0.658639      0.236675      -0.102960  
1885      1.396006       0.858498      1.250199       0.633184  
1880     -0.669750      -0.938603     -0.356199      -0.533577  
1702     -0.669750      -0.938603     -0.356199      -0.533577  
1875     -0.669750      -0.938603     -0.356199      -0.533577  
1896      0.202219      -0.180035     -0.356199      -0.533577  
1870     -0.669750      -0.938603     -0.356199      -0.533577  
1907     -0.669750      -0.938603     -0.356199      -0.533577  
1852     -0.347932      -0.658639     -0.356199      -0.533577  
1849      0.202219      -0.180035     -0.356199      -0.533577  
1821      0.929480       0.452644      0.236675      -0.102960  
1727      0.057510      -0.305924     -0.356199      -0.533577  
1720      1.334922       0.805358      0.983607       0.439552  
1867     -0.669750      -0.938603     -0.356199      -0.533577  
1899     -0.669750      -0.938603     -0.356199      -0.533577  
116      -0.119599      -0.460000      0.236675      -0.102960  
4001     -0.669750      -0.938603     -0.356199      -0.533577  
1409     -0.669750      -0.938603     -0.356199      -0.533577  
412       0.057510      -0.305924     -0.356199      -0.533577  
3869     -0.119599      -0.460000      0.236675      -0.102960  
3189      2.248132       1.599803      2.380763       1.454335  
1855      1.505656       0.953888      1.475599       0.796896  
2818     -0.119599      -0.460000      0.236675      -0.102960  
4886     -0.669750      -0.938603     -0.356199      -0.533577  

[329 rows x 17 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com              NA              NA   
1            comcast             net              NA              NA   
2              gmail             com              NA           gmail   
3              gmail             com              NA              NA   
4              gmail             com              NA              NA   
5                 NA              NA              NA              NA   
6                 NA              NA              NA              NA   
7            hotmail             com              NA             aol   
8              gmail             com              NA              NA   
9              gmail             com              NA              NA   
10           hotmail             com              NA              NA   
11             gmail             com              NA           gmail   
12             gmail             com              NA              NA   
13                NA              NA              NA              NA   
14                NA              NA              NA              NA   
15               aol             com              NA              NA   
16             gmail             com              NA              NA   
17             yahoo             com              NA           gmail   
18             gmail             com              NA              NA   
19               aol             com              NA              NA   
20                NA              NA              NA              NA   
21             yahoo             com              NA              NA   
22             gmail             com              NA              NA   
23           hotmail             com              NA         hotmail   
24           hotmail             com              NA         hotmail   
25             yahoo             com              NA              NA   
26             gmail             com              NA              NA   
27               aol             com              NA              NA   
28             gmail             com              NA              NA   
29             yahoo             com              NA              NA   
...              ...             ...             ...             ...   
5875           yahoo             com              NA              NA   
5876           gmail             com              NA           gmail   
5877         comcast             net              NA              NA   
5878           gmail             com              NA              NA   
5879          icloud             com              NA           gmail   
5880           gmail             com              NA              NA   
5881       anonymous             com              NA       anonymous   
5882              NA              NA              NA              NA   
5883         hotmail             com              NA         hotmail   
5884             att             net              NA              NA   
5885             aol             com              NA              NA   
5886       anonymous             com              NA       anonymous   
5887           yahoo             com              NA           yahoo   
5888             aol             com              NA              NA   
5889           yahoo             com              NA              NA   
5890           yahoo             com              NA              NA   
5891              NA              NA              NA              NA   
5892              me             com              NA              NA   
5893           gmail             com              NA              NA   
5894           gmail             com              NA           gmail   
5895              NA              NA              NA           gmail   
5896          icloud             com              NA              NA   
5897           gmail             com              NA              NA   
5898           gmail             com              NA              NA   
5899           gmail             com              NA              NA   
5900           yahoo             com              NA              NA   
5901           gmail             com              NA              NA   
5902           yahoo             com              NA              NA   
5903         comcast             net              NA              NA   
5904             aol             com              NA              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA              NA  
1                 NA              NA  
2                com              NA  
3                 NA              NA  
4                 NA              NA  
5                 NA              NA  
6                 NA              NA  
7                com              NA  
8                 NA              NA  
9                 NA              NA  
10                NA              NA  
11               com              NA  
12                NA              NA  
13                NA              NA  
14                NA              NA  
15                NA              NA  
16                NA              NA  
17               com              NA  
18                NA              NA  
19                NA              NA  
20                NA              NA  
21                NA              NA  
22                NA              NA  
23               com              NA  
24               com              NA  
25                NA              NA  
26                NA              NA  
27                NA              NA  
28                NA              NA  
29                NA              NA  
...              ...             ...  
5875              NA              NA  
5876             com              NA  
5877              NA              NA  
5878              NA              NA  
5879             com              NA  
5880              NA              NA  
5881             com              NA  
5882              NA              NA  
5883             com              NA  
5884              NA              NA  
5885              NA              NA  
5886             com              NA  
5887             com              NA  
5888              NA              NA  
5889              NA              NA  
5890              NA              NA  
5891              NA              NA  
5892              NA              NA  
5893              NA              NA  
5894             com              NA  
5895             com              NA  
5896              NA              NA  
5897              NA              NA  
5898              NA              NA  
5899              NA              NA  
5900              NA              NA  
5901              NA              NA  
5902              NA              NA  
5903              NA              NA  
5904              NA              NA  

[5905 rows x 6 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com              NA              NA   
1            comcast             net              NA              NA   
2              gmail             com              NA           gmail   
3              gmail             com              NA              NA   
4              gmail             com              NA              NA   
5                 NA              NA              NA              NA   
6                 NA              NA              NA              NA   
7            hotmail             com              NA             aol   
8              gmail             com              NA              NA   
9              gmail             com              NA              NA   
10           hotmail             com              NA              NA   
11             gmail             com              NA           gmail   
12             gmail             com              NA              NA   
13                NA              NA              NA              NA   
14                NA              NA              NA              NA   
15               aol             com              NA              NA   
16             gmail             com              NA              NA   
17             yahoo             com              NA           gmail   
18             gmail             com              NA              NA   
19               aol             com              NA              NA   
20                NA              NA              NA              NA   
21             yahoo             com              NA              NA   
22             gmail             com              NA              NA   
23           hotmail             com              NA         hotmail   
24           hotmail             com              NA         hotmail   
25             yahoo             com              NA              NA   
26             gmail             com              NA              NA   
27               aol             com              NA              NA   
28             gmail             com              NA              NA   
29             yahoo             com              NA              NA   
...              ...             ...             ...             ...   
5875           yahoo             com              NA              NA   
5876           gmail             com              NA           gmail   
5877         comcast             net              NA              NA   
5878           gmail             com              NA              NA   
5879          icloud             com              NA           gmail   
5880           gmail             com              NA              NA   
5881       anonymous             com              NA       anonymous   
5882              NA              NA              NA              NA   
5883         hotmail             com              NA         hotmail   
5884             att             net              NA              NA   
5885             aol             com              NA              NA   
5886       anonymous             com              NA       anonymous   
5887           yahoo             com              NA           yahoo   
5888             aol             com              NA              NA   
5889           yahoo             com              NA              NA   
5890           yahoo             com              NA              NA   
5891              NA              NA              NA              NA   
5892              me             com              NA              NA   
5893           gmail             com              NA              NA   
5894           gmail             com              NA           gmail   
5895              NA              NA              NA           gmail   
5896          icloud             com              NA              NA   
5897           gmail             com              NA              NA   
5898           gmail             com              NA              NA   
5899           gmail             com              NA              NA   
5900           yahoo             com              NA              NA   
5901           gmail             com              NA              NA   
5902           yahoo             com              NA              NA   
5903         comcast             net              NA              NA   
5904             aol             com              NA              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA              NA  
1                 NA              NA  
2                com              NA  
3                 NA              NA  
4                 NA              NA  
5                 NA              NA  
6                 NA              NA  
7                com              NA  
8                 NA              NA  
9                 NA              NA  
10                NA              NA  
11               com              NA  
12                NA              NA  
13                NA              NA  
14                NA              NA  
15                NA              NA  
16                NA              NA  
17               com              NA  
18                NA              NA  
19                NA              NA  
20                NA              NA  
21                NA              NA  
22                NA              NA  
23               com              NA  
24               com              NA  
25                NA              NA  
26                NA              NA  
27                NA              NA  
28                NA              NA  
29                NA              NA  
...              ...             ...  
5875              NA              NA  
5876             com              NA  
5877              NA              NA  
5878              NA              NA  
5879             com              NA  
5880              NA              NA  
5881             com              NA  
5882              NA              NA  
5883             com              NA  
5884              NA              NA  
5885              NA              NA  
5886             com              NA  
5887             com              NA  
5888              NA              NA  
5889              NA              NA  
5890              NA              NA  
5891              NA              NA  
5892              NA              NA  
5893              NA              NA  
5894             com              NA  
5895             com              NA  
5896              NA              NA  
5897              NA              NA  
5898              NA              NA  
5899              NA              NA  
5900              NA              NA  
5901              NA              NA  
5902              NA              NA  
5903              NA              NA  
5904              NA              NA  

[5905 rows x 6 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com              NA              NA   
1            comcast             net              NA              NA   
2              gmail             com              NA           gmail   
3              gmail             com              NA              NA   
4              gmail             com              NA              NA   
5                 NA              NA              NA              NA   
6                 NA              NA              NA              NA   
7            hotmail             com              NA             aol   
8              gmail             com              NA              NA   
9              gmail             com              NA              NA   
10           hotmail             com              NA              NA   
11             gmail             com              NA           gmail   
12             gmail             com              NA              NA   
13                NA              NA              NA              NA   
14                NA              NA              NA              NA   
15               aol             com              NA              NA   
16             gmail             com              NA              NA   
17             yahoo             com              NA           gmail   
18             gmail             com              NA              NA   
19               aol             com              NA              NA   
20                NA              NA              NA              NA   
21             yahoo             com              NA              NA   
22             gmail             com              NA              NA   
23           hotmail             com              NA         hotmail   
24           hotmail             com              NA         hotmail   
25             yahoo             com              NA              NA   
26             gmail             com              NA              NA   
27               aol             com              NA              NA   
28             gmail             com              NA              NA   
29             yahoo             com              NA              NA   
...              ...             ...             ...             ...   
5875           yahoo             com              NA              NA   
5876           gmail             com              NA           gmail   
5877         comcast             net              NA              NA   
5878           gmail             com              NA              NA   
5879          icloud             com              NA           gmail   
5880           gmail             com              NA              NA   
5881       anonymous             com              NA       anonymous   
5882              NA              NA              NA              NA   
5883         hotmail             com              NA         hotmail   
5884             att             net              NA              NA   
5885             aol             com              NA              NA   
5886       anonymous             com              NA       anonymous   
5887           yahoo             com              NA           yahoo   
5888             aol             com              NA              NA   
5889           yahoo             com              NA              NA   
5890           yahoo             com              NA              NA   
5891              NA              NA              NA              NA   
5892              me             com              NA              NA   
5893           gmail             com              NA              NA   
5894           gmail             com              NA           gmail   
5895              NA              NA              NA           gmail   
5896          icloud             com              NA              NA   
5897           gmail             com              NA              NA   
5898           gmail             com              NA              NA   
5899           gmail             com              NA              NA   
5900           yahoo             com              NA              NA   
5901           gmail             com              NA              NA   
5902           yahoo             com              NA              NA   
5903         comcast             net              NA              NA   
5904             aol             com              NA              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA              NA  
1                 NA              NA  
2                com              NA  
3                 NA              NA  
4                 NA              NA  
5                 NA              NA  
6                 NA              NA  
7                com              NA  
8                 NA              NA  
9                 NA              NA  
10                NA              NA  
11               com              NA  
12                NA              NA  
13                NA              NA  
14                NA              NA  
15                NA              NA  
16                NA              NA  
17               com              NA  
18                NA              NA  
19                NA              NA  
20                NA              NA  
21                NA              NA  
22                NA              NA  
23               com              NA  
24               com              NA  
25                NA              NA  
26                NA              NA  
27                NA              NA  
28                NA              NA  
29                NA              NA  
...              ...             ...  
5875              NA              NA  
5876             com              NA  
5877              NA              NA  
5878              NA              NA  
5879             com              NA  
5880              NA              NA  
5881             com              NA  
5882              NA              NA  
5883             com              NA  
5884              NA              NA  
5885              NA              NA  
5886             com              NA  
5887             com              NA  
5888              NA              NA  
5889              NA              NA  
5890              NA              NA  
5891              NA              NA  
5892              NA              NA  
5893              NA              NA  
5894             com              NA  
5895             com              NA  
5896              NA              NA  
5897              NA              NA  
5898              NA              NA  
5899              NA              NA  
5900              NA              NA  
5901              NA              NA  
5902              NA              NA  
5903              NA              NA  
5904              NA              NA  

[5905 rows x 6 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com              NA              NA   
1            comcast             net              NA              NA   
2              gmail             com              NA           gmail   
3              gmail             com              NA              NA   
4              gmail             com              NA              NA   
5                 NA              NA              NA              NA   
6                 NA              NA              NA              NA   
7            hotmail             com              NA             aol   
8              gmail             com              NA              NA   
9              gmail             com              NA              NA   
10           hotmail             com              NA              NA   
11             gmail             com              NA           gmail   
12             gmail             com              NA              NA   
13                NA              NA              NA              NA   
14                NA              NA              NA              NA   
15               aol             com              NA              NA   
16             gmail             com              NA              NA   
17             yahoo             com              NA           gmail   
18             gmail             com              NA              NA   
19               aol             com              NA              NA   
20                NA              NA              NA              NA   
21             yahoo             com              NA              NA   
22             gmail             com              NA              NA   
23           hotmail             com              NA         hotmail   
24           hotmail             com              NA         hotmail   
25             yahoo             com              NA              NA   
26             gmail             com              NA              NA   
27               aol             com              NA              NA   
28             gmail             com              NA              NA   
29             yahoo             com              NA              NA   
...              ...             ...             ...             ...   
5875           yahoo             com              NA              NA   
5876           gmail             com              NA           gmail   
5877         comcast             net              NA              NA   
5878           gmail             com              NA              NA   
5879          icloud             com              NA           gmail   
5880           gmail             com              NA              NA   
5881       anonymous             com              NA       anonymous   
5882              NA              NA              NA              NA   
5883         hotmail             com              NA         hotmail   
5884             att             net              NA              NA   
5885             aol             com              NA              NA   
5886       anonymous             com              NA       anonymous   
5887           yahoo             com              NA           yahoo   
5888             aol             com              NA              NA   
5889           yahoo             com              NA              NA   
5890           yahoo             com              NA              NA   
5891              NA              NA              NA              NA   
5892              me             com              NA              NA   
5893           gmail             com              NA              NA   
5894           gmail             com              NA           gmail   
5895              NA              NA              NA           gmail   
5896          icloud             com              NA              NA   
5897           gmail             com              NA              NA   
5898           gmail             com              NA              NA   
5899           gmail             com              NA              NA   
5900           yahoo             com              NA              NA   
5901           gmail             com              NA              NA   
5902           yahoo             com              NA              NA   
5903         comcast             net              NA              NA   
5904             aol             com              NA              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA              NA  
1                 NA              NA  
2                com              NA  
3                 NA              NA  
4                 NA              NA  
5                 NA              NA  
6                 NA              NA  
7                com              NA  
8                 NA              NA  
9                 NA              NA  
10                NA              NA  
11               com              NA  
12                NA              NA  
13                NA              NA  
14                NA              NA  
15                NA              NA  
16                NA              NA  
17               com              NA  
18                NA              NA  
19                NA              NA  
20                NA              NA  
21                NA              NA  
22                NA              NA  
23               com              NA  
24               com              NA  
25                NA              NA  
26                NA              NA  
27                NA              NA  
28                NA              NA  
29                NA              NA  
...              ...             ...  
5875              NA              NA  
5876             com              NA  
5877              NA              NA  
5878              NA              NA  
5879             com              NA  
5880              NA              NA  
5881             com              NA  
5882              NA              NA  
5883             com              NA  
5884              NA              NA  
5885              NA              NA  
5886             com              NA  
5887             com              NA  
5888              NA              NA  
5889              NA              NA  
5890              NA              NA  
5891              NA              NA  
5892              NA              NA  
5893              NA              NA  
5894             com              NA  
5895             com              NA  
5896              NA              NA  
5897              NA              NA  
5898              NA              NA  
5899              NA              NA  
5900              NA              NA  
5901              NA              NA  
5902              NA              NA  
5903              NA              NA  
5904              NA              NA  

[5905 rows x 6 columns]
original train/test shape: (5905, 437) (5067, 436)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 479) (5067, 478)
original train/test shape: (5905, 437) (5067, 436)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 479) (5067, 478)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com              NA              NA   
1            comcast             net              NA              NA   
2              gmail             com              NA           gmail   
3              gmail             com              NA              NA   
4              gmail             com              NA              NA   
5                 NA              NA              NA              NA   
6                 NA              NA              NA              NA   
7            hotmail             com              NA             aol   
8              gmail             com              NA              NA   
9              gmail             com              NA              NA   
10           hotmail             com              NA              NA   
11             gmail             com              NA           gmail   
12             gmail             com              NA              NA   
13                NA              NA              NA              NA   
14                NA              NA              NA              NA   
15               aol             com              NA              NA   
16             gmail             com              NA              NA   
17             yahoo             com              NA           gmail   
18             gmail             com              NA              NA   
19               aol             com              NA              NA   
20                NA              NA              NA              NA   
21             yahoo             com              NA              NA   
22             gmail             com              NA              NA   
23           hotmail             com              NA         hotmail   
24           hotmail             com              NA         hotmail   
25             yahoo             com              NA              NA   
26             gmail             com              NA              NA   
27               aol             com              NA              NA   
28             gmail             com              NA              NA   
29             yahoo             com              NA              NA   
...              ...             ...             ...             ...   
5875           yahoo             com              NA              NA   
5876           gmail             com              NA           gmail   
5877         comcast             net              NA              NA   
5878           gmail             com              NA              NA   
5879          icloud             com              NA           gmail   
5880           gmail             com              NA              NA   
5881       anonymous             com              NA       anonymous   
5882              NA              NA              NA              NA   
5883         hotmail             com              NA         hotmail   
5884             att             net              NA              NA   
5885             aol             com              NA              NA   
5886       anonymous             com              NA       anonymous   
5887           yahoo             com              NA           yahoo   
5888             aol             com              NA              NA   
5889           yahoo             com              NA              NA   
5890           yahoo             com              NA              NA   
5891              NA              NA              NA              NA   
5892              me             com              NA              NA   
5893           gmail             com              NA              NA   
5894           gmail             com              NA           gmail   
5895              NA              NA              NA           gmail   
5896          icloud             com              NA              NA   
5897           gmail             com              NA              NA   
5898           gmail             com              NA              NA   
5899           gmail             com              NA              NA   
5900           yahoo             com              NA              NA   
5901           gmail             com              NA              NA   
5902           yahoo             com              NA              NA   
5903         comcast             net              NA              NA   
5904             aol             com              NA              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA              NA  
1                 NA              NA  
2                com              NA  
3                 NA              NA  
4                 NA              NA  
5                 NA              NA  
6                 NA              NA  
7                com              NA  
8                 NA              NA  
9                 NA              NA  
10                NA              NA  
11               com              NA  
12                NA              NA  
13                NA              NA  
14                NA              NA  
15                NA              NA  
16                NA              NA  
17               com              NA  
18                NA              NA  
19                NA              NA  
20                NA              NA  
21                NA              NA  
22                NA              NA  
23               com              NA  
24               com              NA  
25                NA              NA  
26                NA              NA  
27                NA              NA  
28                NA              NA  
29                NA              NA  
...              ...             ...  
5875              NA              NA  
5876             com              NA  
5877              NA              NA  
5878              NA              NA  
5879             com              NA  
5880              NA              NA  
5881             com              NA  
5882              NA              NA  
5883             com              NA  
5884              NA              NA  
5885              NA              NA  
5886             com              NA  
5887             com              NA  
5888              NA              NA  
5889              NA              NA  
5890              NA              NA  
5891              NA              NA  
5892              NA              NA  
5893              NA              NA  
5894             com              NA  
5895             com              NA  
5896              NA              NA  
5897              NA              NA  
5898              NA              NA  
5899              NA              NA  
5900              NA              NA  
5901              NA              NA  
5902              NA              NA  
5903              NA              NA  
5904              NA              NA  

[5905 rows x 6 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com           other              NA   
1            comcast           other           other              NA   
2              gmail             com           other           gmail   
3              gmail             com           other              NA   
4              gmail             com           other              NA   
5                 NA           other           other              NA   
6                 NA           other           other              NA   
7            hotmail             com           other           other   
8              gmail             com           other              NA   
9              gmail             com           other              NA   
10           hotmail             com           other              NA   
11             gmail             com           other           gmail   
12             gmail             com           other              NA   
13                NA           other           other              NA   
14                NA           other           other              NA   
15               aol             com           other              NA   
16             gmail             com           other              NA   
17             yahoo             com           other           gmail   
18             gmail             com           other              NA   
19               aol             com           other              NA   
20                NA           other           other              NA   
21             yahoo             com           other              NA   
22             gmail             com           other              NA   
23           hotmail             com           other         hotmail   
24           hotmail             com           other         hotmail   
25             yahoo             com           other              NA   
26             gmail             com           other              NA   
27               aol             com           other              NA   
28             gmail             com           other              NA   
29             yahoo             com           other              NA   
...              ...             ...             ...             ...   
5875           yahoo             com           other              NA   
5876           gmail             com           other           gmail   
5877         comcast           other           other              NA   
5878           gmail             com           other              NA   
5879          icloud             com           other           gmail   
5880           gmail             com           other              NA   
5881       anonymous             com           other       anonymous   
5882              NA           other           other              NA   
5883         hotmail             com           other         hotmail   
5884           other           other           other              NA   
5885             aol             com           other              NA   
5886       anonymous             com           other       anonymous   
5887           yahoo             com           other           other   
5888             aol             com           other              NA   
5889           yahoo             com           other              NA   
5890           yahoo             com           other              NA   
5891              NA           other           other              NA   
5892           other             com           other              NA   
5893           gmail             com           other              NA   
5894           gmail             com           other           gmail   
5895              NA           other           other           gmail   
5896          icloud             com           other              NA   
5897           gmail             com           other              NA   
5898           gmail             com           other              NA   
5899           gmail             com           other              NA   
5900           yahoo             com           other              NA   
5901           gmail             com           other              NA   
5902           yahoo             com           other              NA   
5903         comcast           other           other              NA   
5904             aol             com           other              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA           other  
1                 NA           other  
2              other           other  
3                 NA           other  
4                 NA           other  
5                 NA           other  
6                 NA           other  
7              other           other  
8                 NA           other  
9                 NA           other  
10                NA           other  
11             other           other  
12                NA           other  
13                NA           other  
14                NA           other  
15                NA           other  
16                NA           other  
17             other           other  
18                NA           other  
19                NA           other  
20                NA           other  
21                NA           other  
22                NA           other  
23             other           other  
24             other           other  
25                NA           other  
26                NA           other  
27                NA           other  
28                NA           other  
29                NA           other  
...              ...             ...  
5875              NA           other  
5876           other           other  
5877              NA           other  
5878              NA           other  
5879           other           other  
5880              NA           other  
5881           other           other  
5882              NA           other  
5883           other           other  
5884              NA           other  
5885              NA           other  
5886           other           other  
5887           other           other  
5888              NA           other  
5889              NA           other  
5890              NA           other  
5891              NA           other  
5892              NA           other  
5893              NA           other  
5894           other           other  
5895           other           other  
5896              NA           other  
5897              NA           other  
5898              NA           other  
5899              NA           other  
5900              NA           other  
5901              NA           other  
5902              NA           other  
5903              NA           other  
5904              NA           other  

[5905 rows x 6 columns]
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)

   TransactionAmt  nd_TransactionAmt_normal  nd_TransactionAmt_fraud
0         117.000                  0.306795                -0.059625
1         117.000                  0.306795                -0.059625
2          22.235                 -0.465926                -0.513741
3          59.000                 -0.457572                -0.763410
4          53.970                 -0.556525                -0.854520
5          30.950                 -1.169763                -1.419155
6         311.950                  1.409100                 0.955314
7         100.000                  0.940693                 0.020170
8          26.000                 -1.360007                -1.594321
9         117.000                  0.306795                -0.059625

     P_emaildomain_1 P_emaildomain_2 P_emaildomain_3 R_emaildomain_1  \
0              gmail             com           other              NA   
1            comcast           other           other              NA   
2              gmail             com           other           gmail   
3              gmail             com           other              NA   
4              gmail             com           other              NA   
5                 NA           other           other              NA   
6                 NA           other           other              NA   
7            hotmail             com           other           other   
8              gmail             com           other              NA   
9              gmail             com           other              NA   
10           hotmail             com           other              NA   
11             gmail             com           other           gmail   
12             gmail             com           other              NA   
13                NA           other           other              NA   
14                NA           other           other              NA   
15               aol             com           other              NA   
16             gmail             com           other              NA   
17             yahoo             com           other           gmail   
18             gmail             com           other              NA   
19               aol             com           other              NA   
20                NA           other           other              NA   
21             yahoo             com           other              NA   
22             gmail             com           other              NA   
23           hotmail             com           other         hotmail   
24           hotmail             com           other         hotmail   
25             yahoo             com           other              NA   
26             gmail             com           other              NA   
27               aol             com           other              NA   
28             gmail             com           other              NA   
29             yahoo             com           other              NA   
...              ...             ...             ...             ...   
5875           yahoo             com           other              NA   
5876           gmail             com           other           gmail   
5877         comcast           other           other              NA   
5878           gmail             com           other              NA   
5879          icloud             com           other           gmail   
5880           gmail             com           other              NA   
5881       anonymous             com           other       anonymous   
5882              NA           other           other              NA   
5883         hotmail             com           other         hotmail   
5884           other           other           other              NA   
5885             aol             com           other              NA   
5886       anonymous             com           other       anonymous   
5887           yahoo             com           other           other   
5888             aol             com           other              NA   
5889           yahoo             com           other              NA   
5890           yahoo             com           other              NA   
5891              NA           other           other              NA   
5892           other             com           other              NA   
5893           gmail             com           other              NA   
5894           gmail             com           other           gmail   
5895              NA           other           other           gmail   
5896          icloud             com           other              NA   
5897           gmail             com           other              NA   
5898           gmail             com           other              NA   
5899           gmail             com           other              NA   
5900           yahoo             com           other              NA   
5901           gmail             com           other              NA   
5902           yahoo             com           other              NA   
5903         comcast           other           other              NA   
5904             aol             com           other              NA   

     R_emaildomain_2 R_emaildomain_3  
0                 NA           other  
1                 NA           other  
2              other           other  
3                 NA           other  
4                 NA           other  
5                 NA           other  
6                 NA           other  
7              other           other  
8                 NA           other  
9                 NA           other  
10                NA           other  
11             other           other  
12                NA           other  
13                NA           other  
14                NA           other  
15                NA           other  
16                NA           other  
17             other           other  
18                NA           other  
19                NA           other  
20                NA           other  
21                NA           other  
22                NA           other  
23             other           other  
24             other           other  
25                NA           other  
26                NA           other  
27                NA           other  
28                NA           other  
29                NA           other  
...              ...             ...  
5875              NA           other  
5876           other           other  
5877              NA           other  
5878              NA           other  
5879           other           other  
5880              NA           other  
5881           other           other  
5882              NA           other  
5883           other           other  
5884              NA           other  
5885              NA           other  
5886           other           other  
5887           other           other  
5888              NA           other  
5889              NA           other  
5890              NA           other  
5891              NA           other  
5892              NA           other  
5893              NA           other  
5894           other           other  
5895           other           other  
5896              NA           other  
5897              NA           other  
5898              NA           other  
5899              NA           other  
5900              NA           other  
5901              NA           other  
5902              NA           other  
5903              NA           other  
5904              NA           other  

[5905 rows x 6 columns]
original train/test shape: (5905, 437) (5067, 436)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 479) (5067, 478)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
nd_TransactionAmt_fraud has been added on train_df
nd_TransactionAmt_fraud has been added on test_df
nd_TransactionAmt_normal has been added on train_df
nd_TransactionAmt_normal has been added on test_df
nd_C1_fraud has been added on train_df
nd_C1_fraud has been added on test_df
nd_C1_normal has been added on train_df
nd_C1_normal has been added on test_df
nd_C2_fraud has been added on train_df
nd_C2_fraud has been added on test_df
nd_C2_normal has been added on train_df
nd_C2_normal has been added on test_df
nd_C6_fraud has been added on train_df
nd_C6_fraud has been added on test_df
nd_C6_normal has been added on train_df
nd_C6_normal has been added on test_df
nd_C11_fraud has been added on train_df
nd_C11_fraud has been added on test_df
nd_C11_normal has been added on train_df
nd_C11_normal has been added on test_df
nd_C13_fraud has been added on train_df
nd_C13_fraud has been added on test_df
nd_C13_normal has been added on train_df
nd_C13_normal has been added on test_df
nd_C14_fraud has been added on train_df
nd_C14_fraud has been added on test_df
nd_C14_normal has been added on train_df
nd_C14_normal has been added on test_df
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 434) (5067, 433)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 437) (5067, 436)
after groupby_normalize(), train/test shape: (5905, 479) (5067, 478)
original train/test shape: (5905, 434) (5067, 433)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 338) (5067, 337)
after groupby_normalize(), train/test shape: (5905, 380) (5067, 379)
original train/test shape: (5905, 338) (5067, 337)
after groupby_normalize(), train/test shape: (5905, 380) (5067, 379)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
after groupby_normalize(), train/test shape: (5905, 501) (5067, 500)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 433) (5067, 432)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 434) (506691, 433)
Index(['TransactionID', 'isFraud', 'TransactionDT', 'TransactionAmt',
       'ProductCD', 'card1', 'card2', 'card3', 'card4', 'card5',
       ...
       'card1_amtcount', 'card1_C5count', 'card2_amtcount', 'card2_C5count',
       'card5_amtcount', 'card5_C5count', 'addr1_amtcount', 'addr1_C5count',
       'addr2_amtcount', 'addr2_C5count'],
      dtype='object', length=406)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 473) (506691, 472)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (590540, 473) (506691, 472)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (5905, 434) (5067, 433)
original train/test shape: (590540, 434) (506691, 433)
after groupby_normalize(), train/test shape: (590540, 517) (506691, 516)
original train/test shape: (590540, 434) (506691, 433)
original train/test shape: (5905, 440) (5067, 439)
after groupby_normalize(), train/test shape: (5905, 517) (5067, 516)
Index(['TransactionID', 'isFraud', 'TransactionDT', 'TransactionAmt',
       'ProductCD', 'card1', 'card2', 'card3', 'card4', 'card5',
       ...
       'mean_C13_normal', 'std_C13_normal', 'nd_C13_fraud', 'nd_C13_normal',
       'mean_C14_fraud', 'std_C14_fraud', 'mean_C14_normal', 'std_C14_normal',
       'nd_C14_fraud', 'nd_C14_normal'],
      dtype='object', length=517)
original train/test shape: (590540, 434) (506691, 433)
after groupby_normalize(), train/test shape: (590540, 517) (506691, 516)
Index(['TransactionID', 'isFraud', 'TransactionDT', 'TransactionAmt',
       'ProductCD', 'card1', 'card2', 'card3', 'card4', 'card5',
       ...
       'id_31', 'id_32', 'id_33', 'id_34', 'id_35', 'id_36', 'id_37', 'id_38',
       'DeviceType', 'DeviceInfo'],
      dtype='object', length=434)
size of train_df/test_df after making featuresIndex(['TransactionID', 'isFraud', 'TransactionDT', 'TransactionAmt',
       'ProductCD', 'card1', 'card2', 'card3', 'card4', 'card5',
       ...
       'DeviceInfo_count', 'M1_replaced', 'M2_replaced', 'M3_replaced',
       'M4_replaced', 'M5_replaced', 'M6_replaced', 'M7_replaced',
       'M8_replaced', 'M9_replaced'],
      dtype='object', length=701)
feature engineering version: v2
size of train_df/test_df after making featuresIndex(['TransactionID', 'isFraud', 'TransactionDT', 'TransactionAmt',
       'ProductCD', 'card1', 'card2', 'card3', 'card4', 'card5',
       ...
       'DeviceInfo_count', 'M1_replaced', 'M2_replaced', 'M3_replaced',
       'M4_replaced', 'M5_replaced', 'M6_replaced', 'M7_replaced',
       'M8_replaced', 'M9_replaced'],
      dtype='object', length=701)
feature engineering version: v2
original train/test shape: (5905, 393) (5067, 392)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 393) (5067, 392)
original train/test shape: (5905, 393) (5067, 392)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 393) (5067, 392)
after groupby_normalize(), train/test shape: (5905, 476) (5067, 475)
original train/test shape: (5905, 393) (5067, 392)
original train/test shape: (5905, 501) (5067, 500)
after groupby_normalize(), train/test shape: (5905, 569) (5067, 568)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
after groupby_normalize(), train/test shape: (5905, 516) (5067, 515)
original train/test shape: (5905, 433) (5067, 432)
original train/test shape: (5905, 433) (5067, 432)
